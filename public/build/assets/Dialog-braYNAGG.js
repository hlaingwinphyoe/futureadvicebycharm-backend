import{e as U,r as y,ag as C,ai as m,L as F,M as i,o as b,a as u,U as l,R as w,H as I,c as h,a7 as q,T as P,O as B,V as E}from"./@vue-DjPJmJBm.js";import{_ as T}from"./InputError-DuIKKUKn.js";import{B as O,P as j}from"./@element-plus-7OHurGuN.js";import{G as _}from"./@inertiajs-BHNbm3Fi.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as L}from"./element-plus-LrVxQH71.js";import"./deepmerge-DOl302Ur.js";import"./call-bind-apply-helpers-D2lLUVvI.js";import"./function-bind-CHqF18-c.js";import"./es-errors-BzoIU2Qy.js";import"./qs-DKXisfPe.js";import"./side-channel-Ct4gtEXZ.js";import"./object-inspect-DQgcxug-.js";import"./side-channel-list-Bu_TS6Fk.js";import"./side-channel-map-AEBR1zj1.js";import"./get-intrinsic-Bxi7wI-n.js";import"./es-object-atoms-BR76m4z7.js";import"./math-intrinsics-L1VercBF.js";import"./gopd-C1lCZ5Qs.js";import"./es-define-property-D_7cP-M3.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-DDrUrENM.js";import"./dunder-proto-CAfao6an.js";import"./hasown-DwiY0sux.js";import"./call-bound-DguFMLXM.js";import"./side-channel-weakmap-8WVUVGFG.js";import"./axios-upsvKRUO.js";import"./lodash.clonedeep-jBCF3Pnn.js";import"./lodash.isequal-v2OLR2rF.js";import"./lodash-es-CFXHhIzv.js";import"./@vueuse-DfGEukKn.js";import"./@popperjs-C8Ek51sF.js";import"./@ctrl-CBTFr1m8.js";import"./dayjs--ryK7Xvq.js";import"./async-validator-P8scd9xB.js";import"./memoize-one-DxrTgWdQ.js";import"./normalize-wheel-es-Cg1Do7zv.js";import"./@floating-ui-DHxWKL-w.js";const z={props:["show","title","data","astrologers","currencies"],components:{InputError:T,Plus:O,Delete:j},emits:["closed"],setup(o,r){const e=U({dialogTitle:"",isLoading:!1,virtualForm:new FormData,imgSrc:"",form:{name:"",price:"",astrologer:"",th_price:"",discount_percent:0}}),a=y(),V=()=>{var s=document.getElementById("upload");s.click()},k=s=>{var c=s.target;console.log(c);var d=c.files[0];e.imgSrc=URL.createObjectURL(d),e.virtualForm.append("image",d);var f=document.getElementById("preview_img");f.src=URL.createObjectURL(d),f.onload=function(){URL.revokeObjectURL(f.src)}},g=s=>{e.isLoading=!0,s.validate(c=>{c&&(e.virtualForm.append("name",e.form.name),e.virtualForm.append("price",e.form.price),e.virtualForm.append("th_price",e.form.th_price),e.virtualForm.append("discount_percent",e.form.discount_percent),e.virtualForm.append("astrologer",e.form.astrologer),e.dialogTitle==="Create"?_.post(route("admin.packages.store"),e.virtualForm,{onSuccess:d=>{e.isLoading=!1,n(s),L.success(d.props.flash.success)}}):(e.virtualForm.append("_method","patch"),_.post(route("admin.packages.update",o.data.id),e.virtualForm,{onSuccess:d=>{e.isLoading=!1,n(s),L.success(d.props.flash.success)}})))})},n=s=>{s.resetFields(),r.emit("closed"),e.imgSrc=""},p=()=>{e.dialogTitle=o.title,e.form.name=o.data.name??"",e.form.price=o.data.price??"",e.form.th_price=o.data.th_price??"",e.form.astrologer=o.data.astrologer_id?o.data.astrologer_id:o.astrologers[0].id,e.form.discount_percent=o.data.discount_percent??0,e.imgSrc=o.data.image??""},v=s=>{e.imgSrc="",s&&_.delete(route("admin.packages.destroy-media",s.id),{onSuccess:()=>{e.imgSrc=""}})};return{...C(e),openDialog:p,formRef:a,closeDialog:n,submitDialog:g,selectImage:V,loadFile:k,handleRemove:v}}},M={class:"relative group"},A=["src"],G={class:"dialog-footer"};function H(o,r,e,a,V,k){const g=m("el-input"),n=m("InputError"),p=m("el-form-item"),v=m("el-option"),s=m("el-select"),c=m("Delete"),d=m("el-icon"),f=m("Plus"),S=m("el-form"),D=m("el-button"),R=m("el-dialog");return b(),F(R,{modelValue:e.show,"onUpdate:modelValue":r[11]||(r[11]=t=>e.show=t),onClose:r[12]||(r[12]=t=>a.closeDialog(a.formRef)),onOpen:a.openDialog,draggable:"",title:o.dialogTitle,"close-on-click-modal":!1,width:"500"},{footer:i(()=>[u("div",G,[l(D,{onClick:r[9]||(r[9]=t=>a.closeDialog(a.formRef))},{default:i(()=>r[13]||(r[13]=[w("Cancel")])),_:1}),l(D,{type:"primary",onClick:r[10]||(r[10]=t=>a.submitDialog(a.formRef)),class:I({"opacity-25":o.isLoading}),disabled:o.isLoading},{default:i(()=>r[14]||(r[14]=[w(" Save ")])),_:1},8,["class","disabled"])])]),default:i(()=>[l(S,{"label-width":"120px",ref:"formRef",model:o.form},{default:i(()=>[l(p,{label:"Name",prop:"name",rules:[{required:!0,message:"Name is required",trigger:"blur"}]},{default:i(()=>[l(g,{modelValue:o.form.name,"onUpdate:modelValue":r[0]||(r[0]=t=>o.form.name=t)},null,8,["modelValue"]),l(n,{class:"mt-2",message:o.$page.props.errors.name},null,8,["message"])]),_:1}),l(p,{label:"Price (Ks)",prop:"price",rules:[{required:!0,message:"Price is required",trigger:"blur"}]},{default:i(()=>[l(g,{modelValue:o.form.price,"onUpdate:modelValue":r[1]||(r[1]=t=>o.form.price=t)},null,8,["modelValue"]),l(n,{class:"mt-2",message:o.$page.props.errors.price},null,8,["message"])]),_:1}),l(p,{label:"Price (à¸¿)",prop:"th_price",rules:[{required:!0,message:"Thai Price is required",trigger:"blur"}]},{default:i(()=>[l(g,{modelValue:o.form.th_price,"onUpdate:modelValue":r[2]||(r[2]=t=>o.form.th_price=t)},null,8,["modelValue"]),l(n,{class:"mt-2",message:o.$page.props.errors.th_price},null,8,["message"])]),_:1}),l(p,{label:"Astrologer",prop:"astrologer",rules:[{required:!0,message:"Astrologer is required",trigger:"blur"}]},{default:i(()=>[l(s,{modelValue:o.form.astrologer,"onUpdate:modelValue":r[3]||(r[3]=t=>o.form.astrologer=t),placeholder:"Select",clearable:"",onClear:r[4]||(r[4]=t=>o.form.astrologer="")},{default:i(()=>[(b(!0),h(P,null,q(e.astrologers,t=>(b(),F(v,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(n,{class:"mt-2",message:o.$page.props.errors.astrologer},null,8,["message"])]),_:1}),l(p,{label:"Discount (%)",prop:"discount_percent",rules:[{type:"number",min:0,max:100,message:"Discount must be between 0 and 100",trigger:"blur"}]},{default:i(()=>[l(g,{modelValue:o.form.discount_percent,"onUpdate:modelValue":r[5]||(r[5]=t=>o.form.discount_percent=t),modelModifiers:{number:!0},type:"number",min:"0",max:"100"},null,8,["modelValue"]),l(n,{class:"mt-2",message:o.$page.props.errors.discount_percent},null,8,["message"])]),_:1}),l(p,{label:"Image"},{default:i(()=>[u("div",M,[B(u("img",{id:"preview_img",class:"upload-card object-contain mr-2.5",src:o.imgSrc},null,8,A),[[E,o.imgSrc!=""]]),u("span",{class:"absolute-center hidden group-hover:flex group-hover:bg-black group-hover:bg-opacity-50 w-[148px] h-[148px] text-white items-center justify-center rounded-md",onClick:r[6]||(r[6]=t=>a.handleRemove(e.data))},[l(d,{size:"large",class:"cursor-pointer"},{default:i(()=>[l(c)]),_:1})])]),u("div",{class:"upload-card",onClick:r[8]||(r[8]=(...t)=>a.selectImage&&a.selectImage(...t))},[u("h4",null,[l(d,{size:"large"},{default:i(()=>[l(f)]),_:1})]),u("input",{type:"file",class:"hidden",name:"image",id:"upload",onChange:r[7]||(r[7]=(...t)=>a.loadFile&&a.loadFile(...t)),accept:"image/*"},null,32)]),l(n,{class:"mt-2",message:o.$page.props.errors.image},null,8,["message"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","onOpen","title"])}const Ce=N(z,[["render",H]]);export{Ce as default};
