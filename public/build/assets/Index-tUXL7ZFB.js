import{A as F}from"./AuthenticatedLayout-BwqdLtow.js";import{G as f}from"./@inertiajs-BHNbm3Fi.js";import{d as I}from"./lodash.debounce-D6Lq3Ox3.js";import{e as G,w as H,ag as Q,ai as l,ar as W,c as h,U as e,M as a,T as R,o as k,a as i,Z,R as x,O as q,Q as E,S as c}from"./@vue-DjPJmJBm.js";import K from"./Dialog-braYNAGG.js";import X from"./RemarkDialog-DHyIe9qD.js";import{B as Y,Q as $,R as ee,S as te,P as oe,T as ae}from"./@element-plus-7OHurGuN.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as T,a as u}from"./element-plus-LrVxQH71.js";import"./darkmode-BEaTfPzm.js";import"./moment-C5S46NFB.js";import"./ApplicationLogo-D133QDgo.js";import"./deepmerge-DOl302Ur.js";import"./call-bind-apply-helpers-D2lLUVvI.js";import"./function-bind-CHqF18-c.js";import"./es-errors-BzoIU2Qy.js";import"./qs-DKXisfPe.js";import"./side-channel-Ct4gtEXZ.js";import"./object-inspect-DQgcxug-.js";import"./side-channel-list-Bu_TS6Fk.js";import"./side-channel-map-AEBR1zj1.js";import"./get-intrinsic-Bxi7wI-n.js";import"./es-object-atoms-BR76m4z7.js";import"./math-intrinsics-L1VercBF.js";import"./gopd-C1lCZ5Qs.js";import"./es-define-property-D_7cP-M3.js";import"./has-symbols-BaUvM3gb.js";import"./get-proto-DDrUrENM.js";import"./dunder-proto-CAfao6an.js";import"./hasown-DwiY0sux.js";import"./call-bound-DguFMLXM.js";import"./side-channel-weakmap-8WVUVGFG.js";import"./axios-upsvKRUO.js";import"./lodash.clonedeep-jBCF3Pnn.js";import"./lodash.isequal-v2OLR2rF.js";import"./InputError-DuIKKUKn.js";import"./lodash-es-CFXHhIzv.js";import"./@vueuse-DfGEukKn.js";import"./@popperjs-C8Ek51sF.js";import"./@ctrl-CBTFr1m8.js";import"./dayjs--ryK7Xvq.js";import"./async-validator-P8scd9xB.js";import"./memoize-one-DxrTgWdQ.js";import"./normalize-wheel-es-Cg1Do7zv.js";import"./@floating-ui-DHxWKL-w.js";const ne={props:["packages","astrologers","currencies"],components:{AuthenticatedLayout:F,Dialog:K,Plus:Y,Edit:$,Refresh:ee,Filter:te,Delete:oe,ChatLineRound:ae,RemarkDialog:X},setup(){const t=G({showDialog:!1,showRemarkDialog:!1,isLoading:!1,dialog:{dialogTitle:"",dialogData:{}},remarkDialog:{dialogTitle:"",dialogData:{}},pageList:[10,20,60,80,100],param:{page:1,page_size:10,search:""},bulkDiscount:""}),s=n=>{t.param.page_size=n,d()},_=n=>{t.param.page=n,d()},r=n=>{t.remarkDialog.dialogTitle="Add Remarks",t.remarkDialog.dialogData=JSON.parse(JSON.stringify(n)),t.showRemarkDialog=!0},L=()=>{t.dialog.dialogTitle="Create",t.dialog.dialogData={},t.showDialog=!0},B=n=>{t.dialog.dialogTitle="Edit",t.dialog.dialogData=JSON.parse(JSON.stringify(n)),t.showDialog=!0},y=n=>{T.confirm("Are you sure want to change status of this package?","Confirmation",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning",draggable:!0,closeOnClickModal:!1}).then(()=>{f.patch(route("admin.packages.change-status",n.id),{},{preserveState:!0,onSuccess:m=>{u.success(m.props.flash.success)},onError:m=>{u.error(m.error)}})}).catch(()=>{f.reload(),u({type:"info",message:"Cancel"})})},C=n=>{T.confirm("Are you sure you want to delete?","Warning",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning",draggable:!0,closeOnClickModal:!1}).then(()=>{f.delete(route("admin.packages.destroy",n),{onSuccess:m=>{u.success(m.props.flash.success)},onError:m=>{u.error(m.error)}})}).catch(()=>{u({type:"info",message:"Cancel"})})};H(()=>t.param.search,I(()=>{d()},500));const d=()=>{t.isLoading=!0,f.get("/admin/packages",t.param,{preserveScroll:!0,preserveState:!0,replace:!0,onFinish:()=>{t.isLoading=!1}})},p=()=>{t.showDialog=!1,t.showRemarkDialog=!1},w=()=>{f.get(route("admin.packages.index"))},v=()=>{if(t.bulkDiscount<0||t.bulkDiscount>100){u.error("Discount must be between 0 and 100");return}t.isLoading=!0,f.post(route("admin.packages.bulk-discount"),{discount_percent:t.bulkDiscount},{onSuccess:()=>{u.success("Bulk discount applied!"),t.isLoading=!1,d(),t.bulkDiscount=""},onError:n=>{u.error(n.error),t.isLoading=!1}})};return{...Q(t),addNew:L,handleEdit:B,handleDelete:C,onSizeChange:s,onCurrentChange:_,closeDialog:p,reset:w,changeStatus:y,addRemarks:r,submitBulkDiscount:v}}},re={class:"p-4 container mx-auto overflow-x-auto"},ie={class:"p-4 rounded shadow-sm border index-content"},se={class:"flex items-center justify-between gap-4 xl:gap-0 mt-2 mb-5"},ce={class:"flex items-center gap-3"},de={"element-loading-text":"Loading..."},me=["src","alt"],ue={class:"font-semibold"},pe={style:{"text-decoration":"line-through",color:"#888"}},ge={class:"ml-1"},_e={style:{"text-decoration":"line-through",color:"#888"}},fe={class:"ml-1"},he={key:0},ke={class:"my-5 flex items-center justify-center"};function be(t,s,_,r,L,B){const y=l("Head"),C=l("Plus"),d=l("el-icon"),p=l("el-button"),w=l("el-input"),v=l("el-form-item"),n=l("el-form"),m=l("Refresh"),g=l("el-table-column"),D=l("el-tag"),V=l("el-switch"),A=l("ChatLineRound"),S=l("el-tooltip"),z=l("Edit"),N=l("Delete"),P=l("el-table"),M=l("el-pagination"),O=l("Dialog"),U=l("RemarkDialog"),j=l("AuthenticatedLayout"),J=W("loading");return k(),h(R,null,[e(y,{title:"Packages"}),e(j,null,{default:a(()=>[i("div",re,[s[4]||(s[4]=i("h4",{class:"text-lg font-bold mb-3 ml-1"},"Packages",-1)),i("div",ie,[i("div",se,[i("div",ce,[e(p,{type:"primary",onClick:r.addNew},{default:a(()=>[e(d,null,{default:a(()=>[e(C)]),_:1}),s[2]||(s[2]=i("span",null,"New",-1))]),_:1},8,["onClick"]),e(n,{inline:!0,onSubmit:Z(r.submitBulkDiscount,["prevent"])},{default:a(()=>[e(v,{label:"Bulk Discount (%)",class:"!mb-0 !mr-3"},{default:a(()=>[e(w,{modelValue:t.bulkDiscount,"onUpdate:modelValue":s[0]||(s[0]=o=>t.bulkDiscount=o),modelModifiers:{number:!0},type:"number",min:"0",max:"100",style:{width:"120px"},placeholder:"0-100"},null,8,["modelValue"])]),_:1}),e(p,{type:"primary",onClick:r.submitBulkDiscount},{default:a(()=>s[3]||(s[3]=[x(" Apply to All ")])),_:1},8,["onClick"])]),_:1},8,["onSubmit"])]),i("div",null,[e(w,{modelValue:t.param.search,"onUpdate:modelValue":s[1]||(s[1]=o=>t.param.search=o),style:{width:"200px"},placeholder:"Search Packages"},null,8,["modelValue"]),e(p,{type:"danger",onClick:r.reset,class:"ml-3"},{default:a(()=>[e(d,null,{default:a(()=>[e(m)]),_:1})]),_:1},8,["onClick"])])]),q((k(),h("div",de,[e(P,{data:_.packages.data,"table-layout":"auto","default-sort":{prop:"id",order:"descending"}},{default:a(()=>[e(g,{prop:"id",label:"ID",sortable:""}),e(g,{label:"Image"},{default:a(o=>[o.row.image!=""?(k(),h("img",{key:0,src:o.row.image,class:"h-10 object-cover rounded-md",alt:o.row.name},null,8,me)):E("",!0)]),_:1}),e(g,{label:"Name",sortable:""},{default:a(o=>[i("h5",ue,c(o.row.name),1)]),_:1}),e(g,{label:"Price"},{default:a(o=>[o.row.discount_percent>0?(k(),h(R,{key:0},[e(D,{type:"primary",class:"mr-1"},{default:a(()=>[i("span",pe,c(o.row.price),1),i("span",ge,c(o.row.final_price)+" "+c(o.row.currency),1)]),_:2},1024),e(D,{type:"danger"},{default:a(()=>[i("span",_e,c(o.row.th_price),1),i("span",fe,c(o.row.th_final_price)+" "+c(o.row.th_currency),1)]),_:2},1024)],64)):(k(),h(R,{key:1},[e(D,{type:"primary",class:"mr-1"},{default:a(()=>[x(c(o.row.price)+" "+c(o.row.currency),1)]),_:2},1024),e(D,{type:"danger"},{default:a(()=>[x(c(o.row.th_price)+" "+c(o.row.th_currency),1)]),_:2},1024)],64))]),_:1}),e(g,{label:"Discount (%)",align:"center"},{default:a(o=>[o.row.discount_percent>0?(k(),h("span",he,c(o.row.discount_percent)+" % ",1)):E("",!0)]),_:1}),e(g,{prop:"created_at",label:"Created At",sortable:"",align:"center"}),e(g,{label:"Available",align:"center"},{default:a(o=>[e(V,{modelValue:o.row.disabled,"onUpdate:modelValue":b=>o.row.disabled=b,"active-value":0,"inactive-value":1,onChange:b=>r.changeStatus(o.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(g,{label:"Actions"},{default:a(o=>[e(S,{class:"box-item",content:"Add Remarks",placement:"top"},{default:a(()=>[e(p,{circle:"",style:{"margin-bottom":"5px"},onClick:b=>r.addRemarks(o.row)},{default:a(()=>[e(d,null,{default:a(()=>[e(A)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(S,{class:"box-item",content:"Edit",placement:"top"},{default:a(()=>[e(p,{type:"warning",circle:"",style:{"margin-bottom":"5px"},onClick:b=>r.handleEdit(o.row)},{default:a(()=>[e(d,null,{default:a(()=>[e(z)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(S,{class:"box-item",content:"Delete",placement:"top"},{default:a(()=>[e(p,{type:"danger",circle:"",style:{"margin-bottom":"5px"},onClick:b=>r.handleDelete(o.row.id)},{default:a(()=>[e(d,null,{default:a(()=>[e(N)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"]),i("div",ke,[e(M,{onSizeChange:r.onSizeChange,onCurrentChange:r.onCurrentChange,"page-size":t.param.page_size,background:!0,"page-sizes":t.pageList,"current-page":t.param.page,layout:"total,sizes,prev,pager,next,jumper",total:_.packages.total},null,8,["onSizeChange","onCurrentChange","page-size","page-sizes","current-page","total"])])])),[[J,t.isLoading]])])]),e(O,{show:t.showDialog,onClosed:r.closeDialog,title:t.dialog.dialogTitle,data:t.dialog.dialogData,astrologers:_.astrologers,currencies:_.currencies},null,8,["show","onClosed","title","data","astrologers","currencies"]),e(U,{show:t.showRemarkDialog,onClosed:r.closeDialog,title:t.remarkDialog.dialogTitle,data:t.remarkDialog.dialogData},null,8,["show","onClosed","title","data"])]),_:1})],64)}const mt=le(ne,[["render",be]]);export{mt as default};
