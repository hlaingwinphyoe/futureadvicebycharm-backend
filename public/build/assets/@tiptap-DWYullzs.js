import{d as Dt,r as jt,j as zt,k as Je,h as Ft,s as Vt,g as Wt,m as Kt,n as Ut,u as qt,l as Jt,p as Gt}from"./@vue-Sbvg1l4F.js";import{N as q,P as A,a as L,S as D,T as I,A as Xt,E as Yt}from"./prosemirror-state-BhYcsFuq.js";import{E as Qt,D as te,a as Me}from"./prosemirror-view-D3HAM3aT.js";import{k as Zt}from"./prosemirror-keymap-BFQpi39t.js";import{f as en,c as we,l as tn,j as Ge,a as Z,R as nn,T as rn,b as sn,d as on}from"./prosemirror-transform-DEGi2ToZ.js";import{F as R,S as an,N as ln,a as Xe,D as pe,b as cn}from"./prosemirror-model-DLapjtUi.js";import{c as un,d as dn,e as pn,j as fn,a as hn,b as mn,f as gn,g as yn,h as kn,l as bn,i as vn,n as Mn,s as wn,k as xn,m as Sn,o as En,p as Tn,q as Ne,w as An}from"./prosemirror-commands-COHbUQAb.js";import{l as Cn,s as Ln,w as Pn}from"./prosemirror-schema-list-Cm98daqU.js";import{r as Oe,f as Ye,t as In,a as $n}from"./linkifyjs-DVrXeg1a.js";import{d as Nn}from"./prosemirror-dropcursor-Gs5WRMus.js";import{g as On}from"./prosemirror-gapcursor-BjeWOwQN.js";import{u as Rn,r as Bn,h as Hn}from"./prosemirror-history-sQZCUXNz.js";var _n=Object.defineProperty,Qe=(e,t)=>{for(var n in t)_n(e,n,{get:t[n],enumerable:!0})};function oe(e){const{state:t,transaction:n}=e;let{selection:r}=n,{doc:s}=n,{storedMarks:o}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,o=n.storedMarks,n}}}var ie=class{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:n}=this,{view:r}=t,{tr:s}=n,o=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([i,a])=>[i,(...c)=>{const u=a(...c)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(s),u}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:n,editor:r,state:s}=this,{view:o}=r,i=[],a=!!e,l=e||s.tr,c=()=>(!a&&t&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(l),i.every(d=>d===!0)),u={...Object.fromEntries(Object.entries(n).map(([d,p])=>[d,(...m)=>{const g=this.buildProps(l,t),y=p(...m)(g);return i.push(y),u}])),run:c};return u}createCan(e){const{rawCommands:t,state:n}=this,r=!1,s=e||n.tr,o=this.buildProps(s,r);return{...Object.fromEntries(Object.entries(t).map(([a,l])=>[a,(...c)=>l(...c)({...o,dispatch:void 0})])),chain:()=>this.createChain(s,r)}}buildProps(e,t=!0){const{rawCommands:n,editor:r,state:s}=this,{view:o}=r,i={tr:e,editor:r,view:o,state:oe({state:s,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(([a,l])=>[a,(...c)=>l(...c)(i)]))}};return i}},Dn=class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const n=this.callbacks[e];return n&&n.forEach(r=>r.apply(this,t)),this}off(e,t){const n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(r=>r!==t):delete this.callbacks[e]),this}once(e,t){const n=(...r)=>{this.off(e,n),t.apply(this,r)};return this.on(e,n)}removeAllListeners(){this.callbacks={}}};function Ze(e,t){const n=new rn(e);return t.forEach(r=>{r.steps.forEach(s=>{n.step(s)})}),n}var et=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const r=t[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):r.nodeType===1&&et(r)}return e};function G(e){if(typeof window>"u")throw new Error("[tiptap error]: there is no window object available, so this function cannot be used");const t=`<body>${e}</body>`,n=new window.DOMParser().parseFromString(t,"text/html").body;return et(n)}function K(e,t,n){if(e instanceof ln||e instanceof R)return e;n={slice:!0,parseOptions:{},...n};const r=typeof e=="object"&&e!==null,s=typeof e=="string";if(r)try{if(Array.isArray(e)&&e.length>0)return R.fromArray(e.map(a=>t.nodeFromJSON(a)));const i=t.nodeFromJSON(e);return n.errorOnInvalidContent&&i.check(),i}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",o),K("",t,n)}if(s){if(n.errorOnInvalidContent){let i=!1,a="";const l=new Xe({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(i=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(n.slice?pe.fromSchema(l).parseSlice(G(e),n.parseOptions):pe.fromSchema(l).parse(G(e),n.parseOptions),n.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=pe.fromSchema(t);return n.slice?o.parseSlice(G(e),n.parseOptions).content:o.parse(G(e),n.parseOptions)}return K("",t,n)}function ge(e,t,n={},r={}){return K(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}function jn(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function zn(e,t,n){const r=[];return e.nodesBetween(t.from,t.to,(s,o)=>{n(s)&&r.push({node:s,pos:o})}),r}function Fn(e,t){for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}function ae(e){return t=>Fn(t.$from,e)}function k(e,t,n){return e.config[t]===void 0&&e.parent?k(e.parent,t,n):typeof e.config[t]=="function"?e.config[t].bind({...n,parent:e.parent?k(e.parent,t,n):null}):e.config[t]}function xe(e){return e.map(t=>{const n={name:t.name,options:t.options,storage:t.storage},r=k(t,"addExtensions",n);return r?[t,...xe(r())]:t}).flat(10)}function Se(e,t){const n=cn.fromSchema(t).serializeFragment(e),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}function tt(e){return typeof e=="function"}function M(e,t=void 0,...n){return tt(e)?t?e.bind(t)(...n):e(...n):e}function Vn(e={}){return Object.keys(e).length===0&&e.constructor===Object}function U(e){const t=e.filter(s=>s.type==="extension"),n=e.filter(s=>s.type==="node"),r=e.filter(s=>s.type==="mark");return{baseExtensions:t,nodeExtensions:n,markExtensions:r}}function nt(e){const t=[],{nodeExtensions:n,markExtensions:r}=U(e),s=[...n,...r],o={default:null,validate:void 0,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage,extensions:s},l=k(i,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([p,f])=>{t.push({type:d,name:p,attribute:{...o,...f}})})})})}),s.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage},l=k(i,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const p={...o,...d};typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),p!=null&&p.isRequired&&(p==null?void 0:p.default)===void 0&&delete p.default,t.push({type:i.name,name:u,attribute:p})})}),t}function x(...e){return e.filter(t=>!!t).reduce((t,n)=>{const r={...t};return Object.entries(n).forEach(([s,o])=>{if(!r[s]){r[s]=o;return}if(s==="class"){const a=o?String(o).split(" "):[],l=r[s]?r[s].split(" "):[],c=a.filter(u=>!l.includes(u));r[s]=[...l,...c].join(" ")}else if(s==="style"){const a=o?o.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[s]?r[s].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[d,p]=u.split(":").map(f=>f.trim());c.set(d,p)}),a.forEach(u=>{const[d,p]=u.split(":").map(f=>f.trim());c.set(d,p)}),r[s]=Array.from(c.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[s]=o}),r},{})}function ne(e,t){return t.filter(n=>n.type===e.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(e.attrs)||{}:{[n.name]:e.attrs[n.name]}).reduce((n,r)=>x(n,r),{})}function Wn(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function Re(e,t){return"style"in e?e:{...e,getAttrs:n=>{const r=e.getAttrs?e.getAttrs(n):e.attrs;if(r===!1)return!1;const s=t.reduce((o,i)=>{const a=i.attribute.parseHTML?i.attribute.parseHTML(n):Wn(n.getAttribute(i.name));return a==null?o:{...o,[i.name]:a}},{});return{...r,...s}}}}function Be(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>t==="attrs"&&Vn(n)?!1:n!=null))}function Kn(e,t){var n;const r=nt(e),{nodeExtensions:s,markExtensions:o}=U(e),i=(n=s.find(c=>k(c,"topNode")))==null?void 0:n.name,a=Object.fromEntries(s.map(c=>{const u=r.filter(h=>h.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:t},p=e.reduce((h,b)=>{const v=k(b,"extendNodeSchema",d);return{...h,...v?v(c):{}}},{}),f=Be({...p,content:M(k(c,"content",d)),marks:M(k(c,"marks",d)),group:M(k(c,"group",d)),inline:M(k(c,"inline",d)),atom:M(k(c,"atom",d)),selectable:M(k(c,"selectable",d)),draggable:M(k(c,"draggable",d)),code:M(k(c,"code",d)),whitespace:M(k(c,"whitespace",d)),linebreakReplacement:M(k(c,"linebreakReplacement",d)),defining:M(k(c,"defining",d)),isolating:M(k(c,"isolating",d)),attrs:Object.fromEntries(u.map(h=>{var b,v;return[h.name,{default:(b=h==null?void 0:h.attribute)==null?void 0:b.default,validate:(v=h==null?void 0:h.attribute)==null?void 0:v.validate}]}))}),m=M(k(c,"parseHTML",d));m&&(f.parseDOM=m.map(h=>Re(h,u)));const g=k(c,"renderHTML",d);g&&(f.toDOM=h=>g({node:h,HTMLAttributes:ne(h,u)}));const y=k(c,"renderText",d);return y&&(f.toText=y),[c.name,f]})),l=Object.fromEntries(o.map(c=>{const u=r.filter(y=>y.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:t},p=e.reduce((y,h)=>{const b=k(h,"extendMarkSchema",d);return{...y,...b?b(c):{}}},{}),f=Be({...p,inclusive:M(k(c,"inclusive",d)),excludes:M(k(c,"excludes",d)),group:M(k(c,"group",d)),spanning:M(k(c,"spanning",d)),code:M(k(c,"code",d)),attrs:Object.fromEntries(u.map(y=>{var h,b;return[y.name,{default:(h=y==null?void 0:y.attribute)==null?void 0:h.default,validate:(b=y==null?void 0:y.attribute)==null?void 0:b.validate}]}))}),m=M(k(c,"parseHTML",d));m&&(f.parseDOM=m.map(y=>Re(y,u)));const g=k(c,"renderHTML",d);return g&&(f.toDOM=y=>g({mark:y,HTMLAttributes:ne(y,u)})),[c.name,f]}));return new Xe({topNode:i,nodes:a,marks:l})}function Un(e){const t=e.filter((n,r)=>e.indexOf(n)!==r);return Array.from(new Set(t))}function Ee(e){return e.sort((n,r)=>{const s=k(n,"priority")||100,o=k(r,"priority")||100;return s>o?-1:s<o?1:0})}function rt(e){const t=Ee(xe(e)),n=Un(t.map(r=>r.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),t}function st(e,t,n){const{from:r,to:s}=t,{blockSeparator:o=`

`,textSerializers:i={}}=n||{};let a="";return e.nodesBetween(r,s,(l,c,u,d)=>{var p;l.isBlock&&c>r&&(a+=o);const f=i==null?void 0:i[l.type.name];if(f)return u&&(a+=f({node:l,pos:c,parent:u,index:d,range:t})),!1;l.isText&&(a+=(p=l==null?void 0:l.text)==null?void 0:p.slice(Math.max(r,c)-c,s-c))}),a}function qn(e,t){const n={from:0,to:e.content.size};return st(e,n,t)}function ot(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}function O(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function it(e,t){const n=O(t,e.schema),{from:r,to:s,empty:o}=e.selection,i=[];o?(e.storedMarks&&i.push(...e.storedMarks),i.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,s,l=>{i.push(...l.marks)});const a=i.find(l=>l.type.name===n.name);return a?{...a.attrs}:{}}function S(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function Jn(e,t){const n=S(t,e.schema),{from:r,to:s}=e.selection,o=[];e.doc.nodesBetween(r,s,a=>{o.push(a)});const i=o.reverse().find(a=>a.type.name===n.name);return i?{...i.attrs}:{}}function le(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function at(e,t){const n=le(typeof t=="string"?t:t.name,e.schema);return n==="node"?Jn(e,t):n==="mark"?it(e,t):{}}function Gn(e,t=JSON.stringify){const n={};return e.filter(r=>{const s=t(r);return Object.prototype.hasOwnProperty.call(n,s)?!1:n[s]=!0})}function Xn(e){const t=Gn(e);return t.length===1?t:t.filter((n,r)=>!t.filter((o,i)=>i!==r).some(o=>n.oldRange.from>=o.oldRange.from&&n.oldRange.to<=o.oldRange.to&&n.newRange.from>=o.newRange.from&&n.newRange.to<=o.newRange.to))}function lt(e){const{mapping:t,steps:n}=e,r=[];return t.maps.forEach((s,o)=>{const i=[];if(s.ranges.length)s.forEach((a,l)=>{i.push({from:a,to:l})});else{const{from:a,to:l}=n[o];if(a===void 0||l===void 0)return;i.push({from:a,to:l})}i.forEach(({from:a,to:l})=>{const c=t.slice(o).map(a,-1),u=t.slice(o).map(l),d=t.invert().map(c,-1),p=t.invert().map(u);r.push({oldRange:{from:d,to:p},newRange:{from:c,to:u}})})}),Xn(r)}function Te(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function re(e,t,n={strict:!0}){const r=Object.keys(t);return r.length?r.every(s=>n.strict?t[s]===e[s]:Te(t[s])?t[s].test(e[s]):t[s]===e[s]):!0}function ct(e,t,n={}){return e.find(r=>r.type===t&&re(Object.fromEntries(Object.keys(n).map(s=>[s,r.attrs[s]])),n))}function He(e,t,n={}){return!!ct(e,t,n)}function Ae(e,t,n){var r;if(!e||!t)return;let s=e.parent.childAfter(e.parentOffset);if((!s.node||!s.node.marks.some(u=>u.type===t))&&(s=e.parent.childBefore(e.parentOffset)),!s.node||!s.node.marks.some(u=>u.type===t)||(n=n||((r=s.node.marks[0])==null?void 0:r.attrs),!ct([...s.node.marks],t,n)))return;let i=s.index,a=e.start()+s.offset,l=i+1,c=a+s.node.nodeSize;for(;i>0&&He([...e.parent.child(i-1).marks],t,n);)i-=1,a-=e.parent.child(i).nodeSize;for(;l<e.parent.childCount&&He([...e.parent.child(l).marks],t,n);)c+=e.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function Ce(e,t,n){const r=[];return e===t?n.resolve(e).marks().forEach(s=>{const o=n.resolve(e),i=Ae(o,s.type);i&&r.push({mark:s,...i})}):n.nodesBetween(e,t,(s,o)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(i=>({from:o,to:o+s.nodeSize,mark:i})))}),r}var Yn=(e,t,n,r=20)=>{const s=e.doc.resolve(n);let o=r,i=null;for(;o>0&&i===null;){const a=s.node(o);(a==null?void 0:a.type.name)===t?i=a:o-=1}return[i,o]};function fe(e,t){return t.nodes[e]||t.marks[e]||null}function ee(e,t,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=e.find(o=>o.type===t&&o.name===r);return s?s.attribute.keepOnSplit:!1}))}var Qn=(e,t=500)=>{let n="";const r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(s,o,i,a)=>{var l,c;const u=((c=(l=s.type.spec).toText)==null?void 0:c.call(l,{node:s,pos:o,parent:i,index:a}))||s.textContent||"%leaf%";n+=s.isAtom&&!s.isText?u:u.slice(0,Math.max(0,r-o))}),n};function ye(e,t,n={}){const{empty:r,ranges:s}=e.selection,o=t?O(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>re(d.attrs,n,{strict:!1}));let i=0;const a=[];if(s.forEach(({$from:d,$to:p})=>{const f=d.pos,m=p.pos;e.doc.nodesBetween(f,m,(g,y)=>{if(!g.isText&&!g.marks.length)return;const h=Math.max(f,y),b=Math.min(m,y+g.nodeSize),v=b-h;i+=v,a.push(...g.marks.map(T=>({mark:T,from:h,to:b})))})}),i===0)return!1;const l=a.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>re(d.mark.attrs,n,{strict:!1})).reduce((d,p)=>d+p.to-p.from,0),c=a.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,p)=>d+p.to-p.from,0);return(l>0?l+c:l)>=i}function B(e,t,n={}){const{from:r,to:s,empty:o}=e.selection,i=t?S(t,e.schema):null,a=[];e.doc.nodesBetween(r,s,(d,p)=>{if(d.isText)return;const f=Math.max(r,p),m=Math.min(s,p+d.nodeSize);a.push({node:d,from:f,to:m})});const l=s-r,c=a.filter(d=>i?i.name===d.node.type.name:!0).filter(d=>re(d.node.attrs,n,{strict:!1}));return o?!!c.length:c.reduce((d,p)=>d+p.to-p.from,0)>=l}function Zn(e,t,n={}){if(!t)return B(e,null,n)||ye(e,null,n);const r=le(t,e.schema);return r==="node"?B(e,t,n):r==="mark"?ye(e,t,n):!1}var er=(e,t)=>{const{$from:n,$to:r,$anchor:s}=e.selection;if(t){const o=ae(a=>a.type.name===t)(e.selection);if(!o)return!1;const i=e.doc.resolve(o.pos+1);return s.pos+1===i.end()}return!(r.parentOffset<r.parent.nodeSize-2||n.pos!==r.pos)},tr=e=>{const{$from:t,$to:n}=e.selection;return!(t.parentOffset>0||t.pos!==n.pos)};function _e(e,t){return Array.isArray(t)?t.some(n=>(typeof n=="string"?n:n.name)===e.name):t}function De(e,t){const{nodeExtensions:n}=U(t),r=n.find(i=>i.name===e);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},o=M(k(r,"group",s));return typeof o!="string"?!1:o.split(" ").includes("list")}function ce(e,{checkChildren:t=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((r=e.text)!=null?r:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let s=!0;return e.content.forEach(o=>{s!==!1&&(ce(o,{ignoreWhitespace:n,checkChildren:t})||(s=!1))}),s}return!1}function ut(e){return e instanceof q}function dt(e){return e instanceof I}function _(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function pt(e,t=null){if(!t)return null;const n=D.atStart(e),r=D.atEnd(e);if(t==="start"||t===!0)return n;if(t==="end")return r;const s=n.from,o=r.to;return t==="all"?I.create(e,_(0,s,o),_(e.content.size,s,o)):I.create(e,_(t,s,o),_(t,s,o))}function nr(e,t,n){const r=e.steps.length-1;if(r<t)return;const s=e.steps[r];if(!(s instanceof sn||s instanceof on))return;const o=e.mapping.maps[r];let i=0;o.forEach((a,l,c,u)=>{i===0&&(i=u)}),e.setSelection(D.near(e.doc.resolve(i),n))}var ue=class{constructor(e){this.find=e.find,this.handler=e.handler}},rr=(e,t)=>{if(Te(t))return t.exec(e);const n=t(e);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function X(e){var t;const{editor:n,from:r,to:s,text:o,rules:i,plugin:a}=e,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(t=c.nodeBefore||c.nodeAfter)!=null&&t.marks.find(p=>p.type.spec.code))return!1;let u=!1;const d=Qn(c)+o;return i.forEach(p=>{if(u)return;const f=rr(d,p.find);if(!f)return;const m=l.state.tr,g=oe({state:l.state,transaction:m}),y={from:r-(f[0].length-o.length),to:s},{commands:h,chain:b,can:v}=new ie({editor:n,state:g});p.handler({state:g,range:y,match:f,commands:h,chain:b,can:v})===null||!m.steps.length||(m.setMeta(a,{transform:m,from:r,to:s,text:o}),l.dispatch(m),u=!0)}),u}function sr(e){const{editor:t,rules:n}=e,r=new A({state:{init(){return null},apply(s,o,i){const a=s.getMeta(r);if(a)return a;const l=s.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=Se(R.from(u),i.schema);const{from:d}=l,p=d+u.length;X({editor:t,from:d,to:p,text:u,rules:n,plugin:r})}),s.selectionSet||s.docChanged?null:o}},props:{handleTextInput(s,o,i,a){return X({editor:t,from:o,to:i,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:o}=s.state.selection;o&&X({editor:t,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,o){if(o.key!=="Enter")return!1;const{$cursor:i}=s.state.selection;return i?X({editor:t,from:i.pos,to:i.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function or(e){return Object.prototype.toString.call(e).slice(8,-1)}function Y(e){return or(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function ft(e,t){const n={...e};return Y(e)&&Y(t)&&Object.keys(t).forEach(r=>{Y(t[r])&&Y(e[r])?n[r]=ft(e[r],t[r]):n[r]=t[r]}),n}var Le=class{constructor(e={}){this.type="extendable",this.parent=null,this.child=null,this.name="",this.config={name:this.name},this.config={...this.config,...e},this.name=this.config.name}get options(){return{...M(k(this,"addOptions",{name:this.name}))||{}}}get storage(){return{...M(k(this,"addStorage",{name:this.name,options:this.options}))||{}}}configure(e={}){const t=this.extend({...this.config,addOptions:()=>ft(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new this.constructor({...this.config,...e});return t.parent=this,this.child=t,t.name="name"in e?e.name:t.parent.name,t}},z=class ht extends Le{constructor(){super(...arguments),this.type="mark"}static create(t={}){const n=typeof t=="function"?t():t;return new ht(n)}static handleExit({editor:t,mark:n}){const{tr:r}=t.state,s=t.state.selection.$from;if(s.pos===s.end()){const i=s.marks();if(!!!i.find(c=>(c==null?void 0:c.type.name)===n.name))return!1;const l=i.find(c=>(c==null?void 0:c.type.name)===n.name);return l&&r.removeStoredMark(l),r.insertText(" ",s.pos),t.view.dispatch(r),!0}return!1}configure(t){return super.configure(t)}extend(t){const n=typeof t=="function"?t():t;return super.extend(n)}};function ir(e){return typeof e=="number"}var ar=class{constructor(e){this.find=e.find,this.handler=e.handler}},lr=(e,t,n)=>{if(Te(t))return[...e.matchAll(t)];const r=t(e,n);return r?r.map(s=>{const o=[s.text];return o.index=s.index,o.input=e,o.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(s.replaceWith)),o}):[]};function cr(e){const{editor:t,state:n,from:r,to:s,rule:o,pasteEvent:i,dropEvent:a}=e,{commands:l,chain:c,can:u}=new ie({editor:t,state:n}),d=[];return n.doc.nodesBetween(r,s,(f,m)=>{if(!f.isTextblock||f.type.spec.code)return;const g=Math.max(r,m),y=Math.min(s,m+f.content.size),h=f.textBetween(g-m,y-m,void 0,"ï¿¼");lr(h,o.find,i).forEach(v=>{if(v.index===void 0)return;const T=g+v.index+1,w=T+v[0].length,C={from:n.tr.mapping.map(T),to:n.tr.mapping.map(w)},P=o.handler({state:n,range:C,match:v,commands:l,chain:c,can:u,pasteEvent:i,dropEvent:a});d.push(P)})}),d.every(f=>f!==null)}var Q=null,ur=e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=n.clipboardData)==null||t.setData("text/html",e),n};function dr(e){const{editor:t,rules:n}=e;let r=null,s=!1,o=!1,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:d,to:p,rule:f,pasteEvt:m})=>{const g=u.tr,y=oe({state:u,transaction:g});if(!(!cr({editor:t,state:y,from:Math.max(d-1,0),to:p.b-1,rule:f,pasteEvent:m,dropEvent:a})||!g.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,g}};return n.map(u=>new A({view(d){const p=m=>{var g;r=(g=d.dom.parentElement)!=null&&g.contains(m.target)?d.dom.parentElement:null,r&&(Q=t)},f=()=>{Q&&(Q=null)};return window.addEventListener("dragstart",p),window.addEventListener("dragend",f),{destroy(){window.removeEventListener("dragstart",p),window.removeEventListener("dragend",f)}}},props:{handleDOMEvents:{drop:(d,p)=>{if(o=r===d.dom.parentElement,a=p,!o){const f=Q;f!=null&&f.isEditable&&setTimeout(()=>{const m=f.state.selection;m&&f.commands.deleteRange({from:m.from,to:m.to})},10)}return!1},paste:(d,p)=>{var f;const m=(f=p.clipboardData)==null?void 0:f.getData("text/html");return i=p,s=!!(m!=null&&m.includes("data-pm-slice")),!1}}},appendTransaction:(d,p,f)=>{const m=d[0],g=m.getMeta("uiEvent")==="paste"&&!s,y=m.getMeta("uiEvent")==="drop"&&!o,h=m.getMeta("applyPasteRules"),b=!!h;if(!g&&!y&&!b)return;if(b){let{text:w}=h;typeof w=="string"?w=w:w=Se(R.from(w),f.schema);const{from:C}=h,P=C+w.length,N=ur(w);return l({rule:u,state:f,from:C,to:{b:P},pasteEvt:N})}const v=p.doc.content.findDiffStart(f.doc.content),T=p.doc.content.findDiffEnd(f.doc.content);if(!(!ir(v)||!T||v===T.b))return l({rule:u,state:f,from:v,to:T,pasteEvt:i})}}))}var de=class{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=rt(e),this.schema=Kn(this.extensions,t),this.setupExtensions()}get commands(){return this.extensions.reduce((e,t)=>{const n={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:fe(t.name,this.schema)},r=k(t,"addCommands",n);return r?{...e,...r()}:e},{})}get plugins(){const{editor:e}=this,t=Ee([...this.extensions].reverse()),n=[],r=[],s=t.map(o=>{const i={name:o.name,options:o.options,storage:this.editor.extensionStorage[o.name],editor:e,type:fe(o.name,this.schema)},a=[],l=k(o,"addKeyboardShortcuts",i);let c={};if(o.type==="mark"&&k(o,"exitable",i)&&(c.ArrowRight=()=>z.handleExit({editor:e,mark:o})),l){const m=Object.fromEntries(Object.entries(l()).map(([g,y])=>[g,()=>y({editor:e})]));c={...c,...m}}const u=Zt(c);a.push(u);const d=k(o,"addInputRules",i);_e(o,e.options.enableInputRules)&&d&&n.push(...d());const p=k(o,"addPasteRules",i);_e(o,e.options.enablePasteRules)&&p&&r.push(...p());const f=k(o,"addProseMirrorPlugins",i);if(f){const m=f();a.push(...m)}return a}).flat();return[sr({editor:e,rules:n}),...dr({editor:e,rules:r}),...s]}get attributes(){return nt(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=U(this.extensions);return Object.fromEntries(t.filter(n=>!!k(n,"addNodeView")).map(n=>{const r=this.attributes.filter(a=>a.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:e,type:S(n.name,this.schema)},o=k(n,"addNodeView",s);if(!o)return[];const i=(a,l,c,u,d)=>{const p=ne(a,r);return o()({node:a,view:l,getPos:c,decorations:u,innerDecorations:d,editor:e,extension:n,HTMLAttributes:p})};return[n.name,i]}))}get markViews(){const{editor:e}=this,{markExtensions:t}=U(this.extensions);return Object.fromEntries(t.filter(n=>!!k(n,"addMarkView")).map(n=>{const r=this.attributes.filter(a=>a.type===n.name),s={name:n.name,options:n.options,storage:this.editor.extensionStorage[n.name],editor:e,type:O(n.name,this.schema)},o=k(n,"addMarkView",s);if(!o)return[];const i=(a,l,c)=>{const u=ne(a,r);return o()({mark:a,view:l,inline:c,editor:e,extension:n,HTMLAttributes:u,updateAttributes:d=>{As(a,e,d)}})};return[n.name,i]}))}setupExtensions(){const e=this.extensions;this.editor.extensionStorage=Object.fromEntries(e.map(t=>[t.name,t.storage])),e.forEach(t=>{var n;const r={name:t.name,options:t.options,storage:this.editor.extensionStorage[t.name],editor:this.editor,type:fe(t.name,this.schema)};t.type==="mark"&&((n=M(k(t,"keepOnSplit",r)))==null||n)&&this.splittableMarks.push(t.name);const s=k(t,"onBeforeCreate",r),o=k(t,"onCreate",r),i=k(t,"onUpdate",r),a=k(t,"onSelectionUpdate",r),l=k(t,"onTransaction",r),c=k(t,"onFocus",r),u=k(t,"onBlur",r),d=k(t,"onDestroy",r);s&&this.editor.on("beforeCreate",s),o&&this.editor.on("create",o),i&&this.editor.on("update",i),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}};de.resolve=rt;de.sort=Ee;de.flatten=xe;var pr={};Qe(pr,{ClipboardTextSerializer:()=>gt,Commands:()=>bt,Delete:()=>vt,Drop:()=>Mt,Editable:()=>wt,FocusEvents:()=>St,Keymap:()=>Et,Paste:()=>Tt,Tabindex:()=>At,focusEventsPluginKey:()=>xt});var E=class mt extends Le{constructor(){super(...arguments),this.type="extension"}static create(t={}){const n=typeof t=="function"?t():t;return new mt(n)}configure(t){return super.configure(t)}extend(t){const n=typeof t=="function"?t():t;return super.extend(n)}},gt=E.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new A({key:new L("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:s}=t,{ranges:o}=s,i=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),l=ot(n);return st(r,{from:i,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),yt={};Qe(yt,{blur:()=>fr,clearContent:()=>hr,clearNodes:()=>mr,command:()=>gr,createParagraphNear:()=>yr,cut:()=>kr,deleteCurrentNode:()=>br,deleteNode:()=>vr,deleteRange:()=>Mr,deleteSelection:()=>wr,enter:()=>xr,exitCode:()=>Sr,extendMarkRange:()=>Er,first:()=>Tr,focus:()=>Cr,forEach:()=>Lr,insertContent:()=>Pr,insertContentAt:()=>$r,joinBackward:()=>Rr,joinDown:()=>Or,joinForward:()=>Br,joinItemBackward:()=>Hr,joinItemForward:()=>_r,joinTextblockBackward:()=>Dr,joinTextblockForward:()=>jr,joinUp:()=>Nr,keyboardShortcut:()=>Fr,lift:()=>Vr,liftEmptyBlock:()=>Wr,liftListItem:()=>Kr,newlineInCode:()=>Ur,resetAttributes:()=>qr,scrollIntoView:()=>Jr,selectAll:()=>Gr,selectNodeBackward:()=>Xr,selectNodeForward:()=>Yr,selectParentNode:()=>Qr,selectTextblockEnd:()=>Zr,selectTextblockStart:()=>es,setContent:()=>ts,setMark:()=>rs,setMeta:()=>ss,setNode:()=>os,setNodeSelection:()=>is,setTextSelection:()=>as,sinkListItem:()=>ls,splitBlock:()=>cs,splitListItem:()=>us,toggleList:()=>ds,toggleMark:()=>ps,toggleNode:()=>fs,toggleWrap:()=>hs,undoInputRule:()=>ms,unsetAllMarks:()=>gs,unsetMark:()=>ys,updateAttributes:()=>ks,wrapIn:()=>bs,wrapInList:()=>vs});var fr=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),(n=window==null?void 0:window.getSelection())==null||n.removeAllRanges())}),!0),hr=(e=!0)=>({commands:t})=>t.setContent("",{emitUpdate:e}),mr=()=>({state:e,tr:t,dispatch:n})=>{const{selection:r}=t,{ranges:s}=r;return n&&s.forEach(({$from:o,$to:i})=>{e.doc.nodesBetween(o.pos,i.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=t,d=c.resolve(u.map(l)),p=c.resolve(u.map(l+a.nodeSize)),f=d.blockRange(p);if(!f)return;const m=tn(f);if(a.type.isTextblock){const{defaultType:g}=d.parent.contentMatchAt(d.index());t.setNodeMarkup(f.start,g)}(m||m===0)&&t.lift(f,m)})}),!0},gr=e=>t=>e(t),yr=()=>({state:e,dispatch:t})=>un(e,t),kr=(e,t)=>({editor:n,tr:r})=>{const{state:s}=n,o=s.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);const i=r.mapping.map(t);return r.insert(i,o.content),r.setSelection(new I(r.doc.resolve(Math.max(i-1,0)))),!0},br=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;const s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===r.type){if(t){const a=s.before(o),l=s.after(o);e.delete(a,l).scrollIntoView()}return!0}return!1},vr=e=>({tr:t,state:n,dispatch:r})=>{const s=S(e,n.schema),o=t.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===s){if(r){const l=o.before(i),c=o.after(i);t.delete(l,c).scrollIntoView()}return!0}return!1},Mr=e=>({tr:t,dispatch:n})=>{const{from:r,to:s}=e;return n&&t.delete(r,s),!0},wr=()=>({state:e,dispatch:t})=>dn(e,t),xr=()=>({commands:e})=>e.keyboardShortcut("Enter"),Sr=()=>({state:e,dispatch:t})=>pn(e,t),Er=(e,t={})=>({tr:n,state:r,dispatch:s})=>{const o=O(e,r.schema),{doc:i,selection:a}=n,{$from:l,from:c,to:u}=a;if(s){const d=Ae(l,o,t);if(d&&d.from<=c&&d.to>=u){const p=I.create(i,d.from,d.to);n.setSelection(p)}}return!0},Tr=e=>t=>{const n=typeof e=="function"?e(t):e;for(let r=0;r<n.length;r+=1)if(n[r](t))return!0;return!1};function Ar(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function Pe(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}var Cr=(e=null,t={})=>({editor:n,view:r,tr:s,dispatch:o})=>{t={scrollIntoView:!0,...t};const i=()=>{(Pe()||Ar())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),t!=null&&t.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&e===null||e===!1)return!0;if(o&&e===null&&!dt(n.state.selection))return i(),!0;const a=pt(s.doc,e)||n.state.selection,l=n.state.selection.eq(a);return o&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),i()),!0},Lr=(e,t)=>n=>e.every((r,s)=>t(r,{...n,index:s})),Pr=(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),Ir=e=>!("type"in e),$r=(e,t,n)=>({tr:r,dispatch:s,editor:o})=>{var i;if(s){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;const{selection:l}=o.state,c=h=>{o.emit("contentError",{editor:o,error:h,disableCollaboration:()=>{"collaboration"in o.storage&&typeof o.storage.collaboration=="object"&&o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},u={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{K(t,o.schema,{parseOptions:u,errorOnInvalidContent:!0})}catch(h){c(h)}try{a=K(t,o.schema,{parseOptions:u,errorOnInvalidContent:(i=n.errorOnInvalidContent)!=null?i:o.options.enableContentCheck})}catch(h){return c(h),!1}let{from:d,to:p}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},f=!0,m=!0;if((Ir(a)?a:[a]).forEach(h=>{h.check(),f=f?h.isText&&h.marks.length===0:!1,m=m?h.isBlock:!1}),d===p&&m){const{parent:h}=r.doc.resolve(d);h.isTextblock&&!h.type.spec.code&&!h.childCount&&(d-=1,p+=1)}let y;if(f){if(Array.isArray(t))y=t.map(h=>h.text||"").join("");else if(t instanceof R){let h="";t.forEach(b=>{b.text&&(h+=b.text)}),y=h}else typeof t=="object"&&t&&t.text?y=t.text:y=t;r.insertText(y,d,p)}else{y=a;const h=l.$from.parentOffset===0,b=l.$from.node().isText||l.$from.node().isTextblock,v=l.$from.node().content.size>0;h&&b&&v&&(d=Math.max(0,d-1)),r.replaceWith(d,p,y)}n.updateSelection&&nr(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:d,text:y}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:d,text:y})}return!0},Nr=()=>({state:e,dispatch:t})=>fn(e,t),Or=()=>({state:e,dispatch:t})=>hn(e,t),Rr=()=>({state:e,dispatch:t})=>mn(e,t),Br=()=>({state:e,dispatch:t})=>gn(e,t),Hr=()=>({state:e,dispatch:t,tr:n})=>{try{const r=Ge(e.doc,e.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},_r=()=>({state:e,dispatch:t,tr:n})=>{try{const r=Ge(e.doc,e.selection.$from.pos,1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},Dr=()=>({state:e,dispatch:t})=>yn(e,t),jr=()=>({state:e,dispatch:t})=>kn(e,t);function kt(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function zr(e){const t=e.split(/-(?!$)/);let n=t[t.length-1];n==="Space"&&(n=" ");let r,s,o,i;for(let a=0;a<t.length-1;a+=1){const l=t[a];if(/^(cmd|meta|m)$/i.test(l))i=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))Pe()||kt()?i=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),i&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}var Fr=e=>({editor:t,view:n,tr:r,dispatch:s})=>{const o=zr(e).split(/-(?!$)/),i=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=t.captureTransaction(()=>{n.someProp("handleKeyDown",c=>c(n,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&s&&r.maybeStep(u)}),!0},Vr=(e,t={})=>({state:n,dispatch:r})=>{const s=S(e,n.schema);return B(n,s,t)?bn(n,r):!1},Wr=()=>({state:e,dispatch:t})=>vn(e,t),Kr=e=>({state:t,dispatch:n})=>{const r=S(e,t.schema);return Cn(r)(t,n)},Ur=()=>({state:e,dispatch:t})=>Mn(e,t);function je(e,t){const n=typeof t=="string"?[t]:t;return Object.keys(e).reduce((r,s)=>(n.includes(s)||(r[s]=e[s]),r),{})}var qr=(e,t)=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const a=le(typeof e=="string"?e:e.name,r.schema);return a?(a==="node"&&(o=S(e,r.schema)),a==="mark"&&(i=O(e,r.schema)),s&&n.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{o&&o===c.type&&n.setNodeMarkup(u,void 0,je(c.attrs,t)),i&&c.marks.length&&c.marks.forEach(d=>{i===d.type&&n.addMark(u,u+c.nodeSize,i.create(je(d.attrs,t)))})})}),!0):!1},Jr=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),Gr=()=>({tr:e,dispatch:t})=>{if(t){const n=new Xt(e.doc);e.setSelection(n)}return!0},Xr=()=>({state:e,dispatch:t})=>wn(e,t),Yr=()=>({state:e,dispatch:t})=>xn(e,t),Qr=()=>({state:e,dispatch:t})=>Sn(e,t),Zr=()=>({state:e,dispatch:t})=>En(e,t),es=()=>({state:e,dispatch:t})=>Tn(e,t),ts=(e,{errorOnInvalidContent:t,emitUpdate:n=!0,parseOptions:r={}}={})=>({editor:s,tr:o,dispatch:i,commands:a})=>{const{doc:l}=o;if(r.preserveWhitespace!=="full"){const c=ge(e,s.schema,r,{errorOnInvalidContent:t??s.options.enableContentCheck});return i&&o.replaceWith(0,l.content.size,c).setMeta("preventUpdate",!n),!0}return i&&o.setMeta("preventUpdate",!n),a.insertContentAt({from:0,to:l.content.size},e,{parseOptions:r,errorOnInvalidContent:t??s.options.enableContentCheck})};function ns(e,t,n){var r;const{selection:s}=t;let o=null;if(dt(s)&&(o=s.$cursor),o){const a=(r=e.storedMarks)!=null?r:o.marks();return!!n.isInSet(a)||!a.some(l=>l.type.excludes(n))}const{ranges:i}=s;return i.some(({$from:a,$to:l})=>{let c=a.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(n):!1;return e.doc.nodesBetween(a.pos,l.pos,(u,d,p)=>{if(c)return!1;if(u.isInline){const f=!p||p.type.allowsMarkType(n),m=!!n.isInSet(u.marks)||!u.marks.some(g=>g.type.excludes(n));c=f&&m}return!c}),c})}var rs=(e,t={})=>({tr:n,state:r,dispatch:s})=>{const{selection:o}=n,{empty:i,ranges:a}=o,l=O(e,r.schema);if(s)if(i){const c=it(r,l);n.addStoredMark(l.create({...c,...t}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(p,f)=>{const m=Math.max(f,u),g=Math.min(f+p.nodeSize,d);p.marks.find(h=>h.type===l)?p.marks.forEach(h=>{l===h.type&&n.addMark(m,g,l.create({...h.attrs,...t}))}):n.addMark(m,g,l.create(t))})});return ns(r,n,l)},ss=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),os=(e,t={})=>({state:n,dispatch:r,chain:s})=>{const o=S(e,n.schema);let i;return n.selection.$anchor.sameParent(n.selection.$head)&&(i=n.selection.$anchor.parent.attrs),o.isTextblock?s().command(({commands:a})=>Ne(o,{...i,...t})(n)?!0:a.clearNodes()).command(({state:a})=>Ne(o,{...i,...t})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},is=e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,s=_(e,0,r.content.size),o=q.create(r,s);t.setSelection(o)}return!0},as=e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,{from:s,to:o}=typeof e=="number"?{from:e,to:e}:e,i=I.atStart(r).from,a=I.atEnd(r).to,l=_(s,i,a),c=_(o,i,a),u=I.create(r,l,c);t.setSelection(u)}return!0},ls=e=>({state:t,dispatch:n})=>{const r=S(e,t.schema);return Ln(r)(t,n)};function ze(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const r=n.filter(s=>t==null?void 0:t.includes(s.type.name));e.tr.ensureMarks(r)}}var cs=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:s})=>{const{selection:o,doc:i}=t,{$from:a,$to:l}=o,c=s.extensionManager.attributes,u=ee(c,a.node().type.name,a.node().attrs);if(o instanceof q&&o.node.isBlock)return!a.parentOffset||!Z(i,a.pos)?!1:(r&&(e&&ze(n,s.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,p=a.depth===0?void 0:jn(a.node(-1).contentMatchAt(a.indexAfter(-1)));let f=d&&p?[{type:p,attrs:u}]:void 0,m=Z(t.doc,t.mapping.map(a.pos),1,f);if(!f&&!m&&Z(t.doc,t.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(m=!0,f=p?[{type:p,attrs:u}]:void 0),r){if(m&&(o instanceof I&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,f),p&&!d&&!a.parentOffset&&a.parent.type!==p)){const g=t.mapping.map(a.before()),y=t.doc.resolve(g);a.node(-1).canReplaceWith(y.index(),y.index()+1,p)&&t.setNodeMarkup(t.mapping.map(a.before()),p)}e&&ze(n,s.extensionManager.splittableMarks),t.scrollIntoView()}return m},us=(e,t={})=>({tr:n,state:r,dispatch:s,editor:o})=>{var i;const a=S(e,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const d=l.node(-1);if(d.type!==a)return!1;const p=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(s){let h=R.empty;const b=l.index(-1)?1:l.index(-2)?2:3;for(let N=l.depth-b;N>=l.depth-3;N-=1)h=R.from(l.node(N).copy(h));const v=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,T={...ee(p,l.node().type.name,l.node().attrs),...t},w=((i=a.contentMatch.defaultType)==null?void 0:i.createAndFill(T))||void 0;h=h.append(R.from(a.createAndFill(null,w)||void 0));const C=l.before(l.depth-(b-1));n.replace(C,l.after(-v),new an(h,4-b,0));let P=-1;n.doc.nodesBetween(C,n.doc.content.size,(N,_t)=>{if(P>-1)return!1;N.isTextblock&&N.content.size===0&&(P=_t+1)}),P>-1&&n.setSelection(I.near(n.doc.resolve(P))),n.scrollIntoView()}return!0}const f=c.pos===l.end()?d.contentMatchAt(0).defaultType:null,m={...ee(p,d.type.name,d.attrs),...t},g={...ee(p,l.node().type.name,l.node().attrs),...t};n.delete(l.pos,c.pos);const y=f?[{type:a,attrs:m},{type:f,attrs:g}]:[{type:a,attrs:m}];if(!Z(n.doc,l.pos,2))return!1;if(s){const{selection:h,storedMarks:b}=r,{splittableMarks:v}=o.extensionManager,T=b||h.$to.parentOffset&&h.$from.marks();if(n.split(l.pos,2,y).scrollIntoView(),!T||!s)return!0;const w=T.filter(C=>v.includes(C.type.name));n.ensureMarks(w)}return!0},he=(e,t)=>{const n=ae(i=>i.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=e.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&we(e.doc,n.pos)&&e.join(n.pos),!0},me=(e,t)=>{const n=ae(i=>i.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=e.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&we(e.doc,r)&&e.join(r),!0},ds=(e,t,n,r={})=>({editor:s,tr:o,state:i,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:p}=s.extensionManager,f=S(e,i.schema),m=S(t,i.schema),{selection:g,storedMarks:y}=i,{$from:h,$to:b}=g,v=h.blockRange(b),T=y||g.$to.parentOffset&&g.$from.marks();if(!v)return!1;const w=ae(C=>De(C.type.name,d))(g);if(v.depth>=1&&w&&v.depth-w.depth<=1){if(w.node.type===f)return c.liftListItem(m);if(De(w.node.type.name,d)&&f.validContent(w.node.content)&&a)return l().command(()=>(o.setNodeMarkup(w.pos,f),!0)).command(()=>he(o,f)).command(()=>me(o,f)).run()}return!n||!T||!a?l().command(()=>u().wrapInList(f,r)?!0:c.clearNodes()).wrapInList(f,r).command(()=>he(o,f)).command(()=>me(o,f)).run():l().command(()=>{const C=u().wrapInList(f,r),P=T.filter(N=>p.includes(N.type.name));return o.ensureMarks(P),C?!0:c.clearNodes()}).wrapInList(f,r).command(()=>he(o,f)).command(()=>me(o,f)).run()},ps=(e,t={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:o=!1}=n,i=O(e,r.schema);return ye(r,i,t)?s.unsetMark(i,{extendEmptyMarkRange:o}):s.setMark(i,t)},fs=(e,t,n={})=>({state:r,commands:s})=>{const o=S(e,r.schema),i=S(t,r.schema),a=B(r,o,n);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?s.setNode(i,l):s.setNode(o,{...l,...n})},hs=(e,t={})=>({state:n,commands:r})=>{const s=S(e,n.schema);return B(n,s,t)?r.lift(s):r.wrapIn(s,t)},ms=()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let o;if(s.spec.isInputRules&&(o=s.getState(e))){if(t){const i=e.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)i.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,e.schema.text(o.text,l))}else i.delete(o.from,o.to)}return!0}}return!1},gs=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:r,ranges:s}=n;return r||t&&s.forEach(o=>{e.removeMark(o.$from.pos,o.$to.pos)}),!0},ys=(e,t={})=>({tr:n,state:r,dispatch:s})=>{var o;const{extendEmptyMarkRange:i=!1}=t,{selection:a}=n,l=O(e,r.schema),{$from:c,empty:u,ranges:d}=a;if(!s)return!0;if(u&&i){let{from:p,to:f}=a;const m=(o=c.marks().find(y=>y.type===l))==null?void 0:o.attrs,g=Ae(c,l,m);g&&(p=g.from,f=g.to),n.removeMark(p,f,l)}else d.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,l)});return n.removeStoredMark(l),!0},ks=(e,t={})=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const a=le(typeof e=="string"?e:e.name,r.schema);return a?(a==="node"&&(o=S(e,r.schema)),a==="mark"&&(i=O(e,r.schema)),s&&n.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let d,p,f,m;n.selection.empty?r.doc.nodesBetween(c,u,(g,y)=>{o&&o===g.type&&(f=Math.max(y,c),m=Math.min(y+g.nodeSize,u),d=y,p=g)}):r.doc.nodesBetween(c,u,(g,y)=>{y<c&&o&&o===g.type&&(f=Math.max(y,c),m=Math.min(y+g.nodeSize,u),d=y,p=g),y>=c&&y<=u&&(o&&o===g.type&&n.setNodeMarkup(y,void 0,{...g.attrs,...t}),i&&g.marks.length&&g.marks.forEach(h=>{if(i===h.type){const b=Math.max(y,c),v=Math.min(y+g.nodeSize,u);n.addMark(b,v,i.create({...h.attrs,...t}))}}))}),p&&(d!==void 0&&n.setNodeMarkup(d,void 0,{...p.attrs,...t}),i&&p.marks.length&&p.marks.forEach(g=>{i===g.type&&n.addMark(f,m,i.create({...g.attrs,...t}))}))}),!0):!1},bs=(e,t={})=>({state:n,dispatch:r})=>{const s=S(e,n.schema);return An(s,t)(n,r)},vs=(e,t={})=>({state:n,dispatch:r})=>{const s=S(e,n.schema);return Pn(s,t)(n,r)},bt=E.create({name:"commands",addCommands(){return{...yt}}}),vt=E.create({name:"delete",onUpdate({transaction:e,appendedTransactions:t}){var n,r,s;const o=()=>{var i,a,l,c;if((c=(l=(a=(i=this.editor.options.coreExtensionOptions)==null?void 0:i.delete)==null?void 0:a.filterTransaction)==null?void 0:l.call(a,e))!=null?c:e.getMeta("y-sync$"))return;const u=Ze(e.before,[e,...t]);lt(u).forEach(f=>{u.mapping.mapResult(f.oldRange.from).deletedAfter&&u.mapping.mapResult(f.oldRange.to).deletedBefore&&u.before.nodesBetween(f.oldRange.from,f.oldRange.to,(m,g)=>{const y=g+m.nodeSize-2,h=f.oldRange.from<=g&&y<=f.oldRange.to;this.editor.emit("delete",{type:"node",node:m,from:g,to:y,newFrom:u.mapping.map(g),newTo:u.mapping.map(y),deletedRange:f.oldRange,newRange:f.newRange,partial:!h,editor:this.editor,transaction:e,combinedTransform:u})})});const p=u.mapping;u.steps.forEach((f,m)=>{var g,y;if(f instanceof nn){const h=p.slice(m).map(f.from,-1),b=p.slice(m).map(f.to),v=p.invert().map(h,-1),T=p.invert().map(b),w=(g=u.doc.nodeAt(h-1))==null?void 0:g.marks.some(P=>P.eq(f.mark)),C=(y=u.doc.nodeAt(b))==null?void 0:y.marks.some(P=>P.eq(f.mark));this.editor.emit("delete",{type:"mark",mark:f.mark,from:f.from,to:f.to,deletedRange:{from:v,to:T},newRange:{from:h,to:b},partial:!!(C||w),editor:this.editor,transaction:e,combinedTransform:u})}})};(s=(r=(n=this.editor.options.coreExtensionOptions)==null?void 0:n.delete)==null?void 0:r.async)==null||s?setTimeout(o,0):o()}}),Mt=E.create({name:"drop",addProseMirrorPlugins(){return[new A({key:new L("tiptapDrop"),props:{handleDrop:(e,t,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:r})}}})]}}),wt=E.create({name:"editable",addProseMirrorPlugins(){return[new A({key:new L("editable"),props:{editable:()=>this.editor.options.editable}})]}}),xt=new L("focusEvents"),St=E.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new A({key:xt,props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;const r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),Et=E.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:p,parent:f}=d,m=d.parent.isTextblock&&p>0?a.doc.resolve(p-1):d,g=m.parent.type.spec.isolating,y=d.pos-d.parentOffset,h=g&&m.parent.childCount===1?y===d.pos:D.atStart(c).from===p;return!u||!f.type.isTextblock||f.textContent.length||!h||h&&d.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},o={...r,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return Pe()||kt()?o:s},addProseMirrorPlugins(){return[new A({key:new L("clearDocument"),appendTransaction:(e,t,n)=>{if(e.some(g=>g.getMeta("composition")))return;const r=e.some(g=>g.docChanged)&&!t.doc.eq(n.doc),s=e.some(g=>g.getMeta("preventClearDocument"));if(!r||s)return;const{empty:o,from:i,to:a}=t.selection,l=D.atStart(t.doc).from,c=D.atEnd(t.doc).to;if(o||!(i===l&&a===c)||!ce(n.doc))return;const p=n.tr,f=oe({state:n,transaction:p}),{commands:m}=new ie({editor:this.editor,state:f});if(m.clearNodes(),!!p.steps.length)return p}})]}}),Tt=E.create({name:"paste",addProseMirrorPlugins(){return[new A({key:new L("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),At=E.create({name:"tabindex",addProseMirrorPlugins(){return[new A({key:new L("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}}),Ms=class F{constructor(t,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=t,this.editor=n,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!=null?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You canât set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(t);return new F(n,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new F(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new F(t,this.editor)}get children(){const t=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,i=this.pos+r+(o?0:1);if(i<0||i>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(i);if(!s&&a.depth<=this.depth)return;const l=new F(a,this.editor,s,s?n:null);s&&(l.actualDepth=this.depth+1),t.push(new F(a,this.editor,s,s?n:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===t)if(Object.keys(n).length>0){const o=s.node.attrs,i=Object.keys(n);for(let a=0;a<i.length;a+=1){const l=i[a];if(o[l]!==n[l])break}}else r=s;s=s.parent}return r}querySelector(t,n={}){return this.querySelectorAll(t,n,!0)[0]||null}querySelectorAll(t,n={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const o=Object.keys(n);return this.children.forEach(i=>{r&&s.length>0||(i.node.type.name===t&&o.every(l=>n[l]===i.node.attrs[l])&&s.push(i),!(r&&s.length>0)&&(s=s.concat(i.querySelectorAll(t,n,r))))}),s}setAttribute(t){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(n)}},ws=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}`;function xs(e,t,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return t&&s.setAttribute("nonce",t),s.setAttribute("data-tiptap-style",""),s.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(s),s}var Ss=class extends Dn{constructor(t={}){super(),this.css=null,this.editorView=null,this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.instanceId=Math.random().toString(36).slice(2,9),this.options={element:typeof document<"u"?document.createElement("div"):null,content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:s})=>{throw s},onPaste:()=>null,onDrop:()=>null,onDelete:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:s,slice:o,moved:i})=>this.options.onDrop(s,o,i)),this.on("paste",({event:s,slice:o})=>this.options.onPaste(s,o)),this.on("delete",this.options.onDelete);const n=this.createDoc(),r=pt(n,this.options.autofocus);this.editorState=Yt.create({doc:n,schema:this.schema,selection:r||void 0}),this.options.element&&this.mount(this.options.element)}mount(t){if(typeof document>"u")throw new Error("[tiptap error]: The editor cannot be mounted because there is no 'document' defined in this environment.");this.createView(t),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}unmount(){var t;if(this.editorView){const n=this.editorView.dom;n!=null&&n.editor&&delete n.editor,this.editorView.destroy()}this.editorView=null,this.isInitialized=!1,(t=this.css)==null||t.remove(),this.css=null}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&typeof document<"u"&&(this.css=xs(ws,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.editorView||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,n=!0){this.setOptions({editable:t}),n&&this.emit("update",{editor:this,transaction:this.state.tr,appendedTransactions:[]})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get view(){return this.editorView?this.editorView:new Proxy({state:this.editorState,updateState:t=>{this.editorState=t},dispatch:t=>{this.editorState=this.state.apply(t)},composing:!1,dragging:null,editable:!0,isDestroyed:!1},{get:(t,n)=>{if(n==="state")return this.editorState;if(n in t)return Reflect.get(t,n);throw new Error(`[tiptap error]: The editor view is not available. Cannot access view['${n}']. The editor may not be mounted yet.`)}})}get state(){return this.editorView&&(this.editorState=this.view.state),this.editorState}registerPlugin(t,n){const r=tt(n)?n(t,[...this.state.plugins]):[...this.state.plugins,t],s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}unregisterPlugin(t){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(t).forEach(o=>{const i=typeof o=="string"?`${o}$`:o.key;r=r.filter(a=>!a.key.startsWith(i))}),n.length===r.length)return;const s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}createExtensionManager(){var t,n;const s=[...this.options.enableCoreExtensions?[wt,gt.configure({blockSeparator:(n=(t=this.options.coreExtensionOptions)==null?void 0:t.clipboardTextSerializer)==null?void 0:n.blockSeparator}),bt,St,Et,At,Mt,Tt,vt].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new de(s,this)}createCommandManager(){this.commandManager=new ie({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createDoc(){let t;try{t=ge(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(n){if(!(n instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(n.message))throw n;this.emit("contentError",{editor:this,error:n,disableCollaboration:()=>{"collaboration"in this.storage&&typeof this.storage.collaboration=="object"&&this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(r=>r.name!=="collaboration"),this.createExtensionManager()}}),t=ge(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}return t}createView(t){var n;this.editorView=new Qt(t,{...this.options.editorProps,attributes:{role:"textbox",...(n=this.options.editorProps)==null?void 0:n.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:this.editorState});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass(),this.injectCSS();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({markViews:this.extensionManager.markViews,nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(u=>{var d;return(d=this.capturedTransaction)==null?void 0:d.step(u)});return}const{state:n,transactions:r}=this.state.applyTransaction(t),s=!this.state.selection.eq(n.selection),o=r.includes(t),i=this.state;if(this.emit("beforeTransaction",{editor:this,transaction:t,nextState:n}),!o)return;this.view.updateState(n),this.emit("transaction",{editor:this,transaction:t,appendedTransactions:r.slice(1)}),s&&this.emit("selectionUpdate",{editor:this,transaction:t});const a=r.findLast(u=>u.getMeta("focus")||u.getMeta("blur")),l=a==null?void 0:a.getMeta("focus"),c=a==null?void 0:a.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:a}),c&&this.emit("blur",{editor:this,event:c.event,transaction:a}),!(t.getMeta("preventUpdate")||!r.some(u=>u.docChanged)||i.doc.eq(n.doc))&&this.emit("update",{editor:this,transaction:t,appendedTransactions:r.slice(1)})}getAttributes(t){return at(this.state,t)}isActive(t,n){const r=typeof t=="string"?t:null,s=typeof t=="string"?n:t;return Zn(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Se(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:n=`

`,textSerializers:r={}}=t||{};return qn(this.state.doc,{blockSeparator:n,textSerializers:{...ot(this.schema),...r}})}get isEmpty(){return ce(this.state.doc)}destroy(){this.emit("destroy"),this.unmount(),this.removeAllListeners()}get isDestroyed(){var t,n;return(n=(t=this.editorView)==null?void 0:t.isDestroyed)!=null?n:!0}$node(t,n){var r;return((r=this.$doc)==null?void 0:r.querySelector(t,n))||null}$nodes(t,n){var r;return((r=this.$doc)==null?void 0:r.querySelectorAll(t,n))||null}$pos(t){const n=this.state.doc.resolve(t);return new Ms(n,this)}get $doc(){return this.$pos(0)}};function V(e){return new ue({find:e.find,handler:({state:t,range:n,match:r})=>{const s=M(e.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:o}=t,i=r[r.length-1],a=r[0];if(i){const l=a.search(/\S/),c=n.from+a.indexOf(i),u=c+i.length;if(Ce(n.from,n.to,t.doc).filter(f=>f.mark.type.excluded.find(g=>g===e.type&&g!==f.mark.type)).filter(f=>f.to>c).length)return null;u<n.to&&o.delete(u,n.to),c>n.from&&o.delete(n.from+l,c);const p=n.from+l+i.length;o.addMark(n.from+l,p,e.type.create(s||{})),o.removeStoredMark(e.type)}}})}function Es(e){return new ue({find:e.find,handler:({state:t,range:n,match:r})=>{const s=M(e.getAttributes,void 0,r)||{},{tr:o}=t,i=n.from;let a=n.to;const l=e.type.create(s);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=i+c;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];o.insertText(d,i+r[0].length-1),o.replaceWith(u,a,l)}else if(r[0]){const c=e.type.isInline?i:i-1;o.insert(c,e.type.create(s)).delete(o.mapping.map(i),o.mapping.map(a))}o.scrollIntoView()}})}function ke(e){return new ue({find:e.find,handler:({state:t,range:n,match:r})=>{const s=t.doc.resolve(n.from),o=M(e.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,o)}})}function W(e){return new ue({find:e.find,handler:({state:t,range:n,match:r,chain:s})=>{const o=M(e.getAttributes,void 0,r)||{},i=t.tr.delete(n.from,n.to),l=i.doc.resolve(n.from).blockRange(),c=l&&en(l,e.type,o);if(!c)return null;if(i.wrap(l,c),e.keepMarks&&e.editor){const{selection:d,storedMarks:p}=t,{splittableMarks:f}=e.editor.extensionManager,m=p||d.$to.parentOffset&&d.$from.marks();if(m){const g=m.filter(y=>f.includes(y.type.name));i.ensureMarks(g)}}if(e.keepAttributes){const d=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(d,o).run()}const u=i.doc.resolve(n.from-1).nodeBefore;u&&u.type===e.type&&we(i.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,u))&&i.join(n.from-1)}})}function Ts(e,t){const{selection:n}=e,{$from:r}=n;if(n instanceof q){const o=r.index();return r.parent.canReplaceWith(o,o+1,t)}let s=r.depth;for(;s>=0;){const o=r.index(s);if(r.node(s).contentMatchAt(o).matchType(t))return!0;s-=1}return!1}function As(e,t,n={}){const{state:r}=t,{doc:s,tr:o}=r,i=e;s.descendants((a,l)=>{const c=o.mapping.map(l),u=o.mapping.map(l)+a.nodeSize;let d=null;if(a.marks.forEach(f=>{if(f!==i)return!1;d=f}),!d)return;let p=!1;if(Object.keys(n).forEach(f=>{n[f]!==d.attrs[f]&&(p=!0)}),p){const f=e.type.create({...e.attrs,...n});o.removeMark(c,u,e.type),o.addMark(c,u,f)}}),o.docChanged&&t.view.dispatch(o)}var $=class Ct extends Le{constructor(){super(...arguments),this.type="node"}static create(t={}){const n=typeof t=="function"?t():t;return new Ct(n)}configure(t){return super.configure(t)}extend(t){const n=typeof t=="function"?t():t;return super.extend(n)}};function j(e){return new ar({find:e.find,handler:({state:t,range:n,match:r,pasteEvent:s})=>{const o=M(e.getAttributes,void 0,r,s);if(o===!1||o===null)return null;const{tr:i}=t,a=r[r.length-1],l=r[0];let c=n.to;if(a){const u=l.search(/\S/),d=n.from+l.indexOf(a),p=d+a.length;if(Ce(n.from,n.to,t.doc).filter(m=>m.mark.type.excluded.find(y=>y===e.type&&y!==m.mark.type)).filter(m=>m.to>d).length)return null;p<n.to&&i.delete(p,n.to),d>n.from&&i.delete(n.from+u,d),c=n.from+u+a.length,i.addMark(n.from+u,c,e.type.create(o||{})),i.removeStoredMark(e.type)}}})}function Fe(e){return Jt((t,n)=>({get(){return t(),e},set(r){e=r,requestAnimationFrame(()=>{requestAnimationFrame(()=>{n()})})}}))}var Cs=class extends Ss{constructor(e={}){return super(e),this.contentComponent=null,this.appContext=null,this.reactiveState=Fe(this.view.state),this.reactiveExtensionStorage=Fe(this.extensionStorage),this.on("beforeTransaction",({nextState:t})=>{this.reactiveState.value=t,this.reactiveExtensionStorage.value=this.extensionStorage}),Kt(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(e,t){const n=super.registerPlugin(e,t);return this.reactiveState&&(this.reactiveState.value=n),n}unregisterPlugin(e){const t=super.unregisterPlugin(e);return this.reactiveState&&t&&(this.reactiveState.value=t),t}},Do=Dt({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(e){const t=jt(),n=Gt();return zt(()=>{const r=e.editor;r&&r.options.element&&t.value&&Ut(()=>{var s;if(!t.value||!((s=r.options.element)!=null&&s.firstChild))return;const o=qt(t.value);t.value.append(...r.options.element.childNodes),r.contentComponent=n.ctx._,n&&(r.appContext={...n.appContext,provides:n.provides}),r.setOptions({element:o}),r.createNodeViews()})}),Je(()=>{const r=e.editor;r&&(r.contentComponent=null,r.appContext=null)}),{rootEl:t}},render(){return Ft("div",{ref:e=>{this.rootEl=e}})}}),jo=(e={})=>{const t=Vt();return Wt(()=>{t.value=new Cs(e)}),Je(()=>{var n,r,s;const o=(n=t.value)==null?void 0:n.options.element,i=o==null?void 0:o.cloneNode(!0);(r=o==null?void 0:o.parentNode)==null||r.replaceChild(i,o),(s=t.value)==null||s.destroy()}),t},se=(e,t)=>{if(e==="slot")return 0;if(e instanceof Function)return e(t);const{children:n,...r}=t??{};if(e==="svg")throw new Error("SVG elements are not supported in the JSX syntax, use the array syntax instead");return[e,r,n]},Ls=/^\s*>\s$/,Ps=$.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return se("blockquote",{...x(this.options.HTMLAttributes,e),children:se("slot",{})})},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[W({find:Ls,type:this.type})]}}),Is=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,$s=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Ns=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,Os=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Rs=z.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return se("strong",{...x(this.options.HTMLAttributes,e),children:se("slot",{})})},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[V({find:Is,type:this.type}),V({find:Ns,type:this.type})]},addPasteRules(){return[j({find:$s,type:this.type}),j({find:Os,type:this.type})]}}),Bs=/(^|[^`])`([^`]+)`(?!`)/,Hs=/(^|[^`])`([^`]+)`(?!`)/g,_s=z.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",x(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[V({find:Bs,type:this.type})]},addPasteRules(){return[j({find:Hs,type:this.type})]}}),Ds=/^```([a-z]+)?[\s\n]$/,js=/^~~~([a-z]+)?[\s\n]$/,zs=$.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,o=[...((t=e.firstElementChild)==null?void 0:t.classList)||[]].filter(i=>i.startsWith(n)).map(i=>i.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",x(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=t.pos===1;return!e||t.parent.type.name!==this.name?!1:n||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,i=r.parent.textContent.endsWith(`

`);return!o||!i?!1:e.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:r}=t,{$from:s,empty:o}=n;if(!o||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0?!1:r.nodeAt(a)?e.commands.command(({tr:c})=>(c.setSelection(D.near(r.resolve(a))),!0)):e.commands.exitCode()}}},addInputRules(){return[ke({find:Ds,type:this.type,getAttributes:e=>({language:e[1]})}),ke({find:js,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new A({key:new L("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,o=s==null?void 0:s.mode;if(!n||!o)return!1;const{tr:i,schema:a}=e.state,l=a.text(n.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:o},l)),i.selection.$from.parent.type!==this.type&&i.setSelection(I.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),e.dispatch(i),!0}}})]}}),Fs=$.create({name:"doc",topNode:!0,content:"block+"}),Vs=$.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",x(this.options.HTMLAttributes,e)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:s,storedMarks:o}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:a}=r.extensionManager,l=o||s.$to.parentOffset&&s.$from.marks();return t().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&i){const d=l.filter(p=>a.includes(p.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Ws=$.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,x(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>ke({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),Ks=$.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",x(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{if(!Ts(t,t.schema.nodes[this.name]))return!1;const{selection:n}=t,{$to:r}=n,s=e();return ut(n)?s.insertContentAt(r.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({tr:o,dispatch:i})=>{var a;if(i){const{$to:l}=o.selection,c=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?o.setSelection(I.create(o.doc,l.pos+1)):l.nodeAfter.isBlock?o.setSelection(q.create(o.doc,l.pos)):o.setSelection(I.create(o.doc,l.pos));else{const u=(a=l.parent.type.contentMatch.defaultType)==null?void 0:a.create();u&&(o.insert(c,u),o.setSelection(I.create(o.doc,c+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[Es({find:/^(?:---|â-|___\s|\*\*\*\s)$/,type:this.type})]}}),Us=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,qs=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Js=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Gs=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,Xs=z.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",x(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[V({find:Us,type:this.type}),V({find:Js,type:this.type})]},addPasteRules(){return[j({find:qs,type:this.type}),j({find:Gs,type:this.type})]}}),Ie="[\0- Â áá â-\u2029âã]",Ys=new RegExp(Ie),Qs=new RegExp(`${Ie}$`),Zs=new RegExp(Ie,"g");function eo(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function to(e){return new A({key:new L("autolink"),appendTransaction:(t,n,r)=>{const s=t.some(c=>c.docChanged)&&!n.doc.eq(r.doc),o=t.some(c=>c.getMeta("preventAutolink"));if(!s||o)return;const{tr:i}=r,a=Ze(n.doc,[...t]);if(lt(a).forEach(({newRange:c})=>{const u=zn(r.doc,c,f=>f.isTextblock);let d,p;if(u.length>1)d=u[0],p=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ");else if(u.length){const f=r.doc.textBetween(c.from,c.to," "," ");if(!Qs.test(f))return;d=u[0],p=r.doc.textBetween(d.pos,c.to,void 0," ")}if(d&&p){const f=p.split(Ys).filter(Boolean);if(f.length<=0)return!1;const m=f[f.length-1],g=d.pos+p.lastIndexOf(m);if(!m)return!1;const y=In(m).map(h=>h.toObject(e.defaultProtocol));if(!eo(y))return!1;y.filter(h=>h.isLink).map(h=>({...h,from:g+h.start+1,to:g+h.end+1})).filter(h=>r.schema.marks.code?!r.doc.rangeHasMark(h.from,h.to,r.schema.marks.code):!0).filter(h=>e.validate(h.value)).filter(h=>e.shouldAutoLink(h.value)).forEach(h=>{Ce(h.from,h.to,r.doc).some(b=>b.mark.type===e.type)||i.addMark(h.from,h.to,e.type.create({href:h.href}))})}}),!!i.steps.length)return i}})}function no(e){return new A({key:new L("handleClickLink"),props:{handleClick:(t,n,r)=>{var s,o;if(r.button!==0||!t.editable)return!1;let i=null;if(r.target instanceof HTMLAnchorElement)i=r.target;else{let u=r.target;const d=[];for(;u.nodeName!=="DIV";)d.push(u),u=u.parentNode;i=d.find(p=>p.nodeName==="A")}if(!i)return!1;const a=at(t.state,e.type.name),l=(s=i==null?void 0:i.href)!=null?s:a.href,c=(o=i==null?void 0:i.target)!=null?o:a.target;return e.enableClickSelection&&e.editor.commands.extendMarkRange(e.type.name),i&&l?(window.open(l,c),!0):!1}}})}function ro(e){return new A({key:new L("handlePasteLink"),props:{handlePaste:(t,n,r)=>{const{state:s}=t,{selection:o}=s,{empty:i}=o;if(i)return!1;let a="";r.content.forEach(c=>{a+=c.textContent});const l=Ye(a,{defaultProtocol:e.defaultProtocol}).find(c=>c.isLink&&c.value===a);return!a||!l?!1:e.editor.commands.setMark(e.type,{href:l.href})}}})}function H(e,t){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&n.push(s)}),!e||e.replace(Zs,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z0-9+.-]+(?:[^a-z+.-:]|$))`,"i"))}var so=z.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.validate&&!this.options.shouldAutoLink&&(this.options.shouldAutoLink=this.options.validate,console.warn("The `validate` option is deprecated. Rename to the `shouldAutoLink` option instead.")),this.options.protocols.forEach(e=>{if(typeof e=="string"){Oe(e);return}Oe(e.scheme,e.optionalSlashes)})},onDestroy(){$n()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,enableClickSelection:!1,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},isAllowedUri:(e,t)=>!!H(e,t.protocols),validate:e=>!!e,shouldAutoLink:e=>!!e}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!t||!this.options.isAllowedUri(t,{defaultValidate:n=>!!H(n,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:null}}]},renderHTML({HTMLAttributes:e}){return this.options.isAllowedUri(e.href,{defaultValidate:t=>!!H(t,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?["a",x(this.options.HTMLAttributes,e),0]:["a",x(this.options.HTMLAttributes,{...e,href:""}),0]},addCommands(){return{setLink:e=>({chain:t})=>{const{href:n}=e;return this.options.isAllowedUri(n,{defaultValidate:r=>!!H(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?t().setMark(this.name,e).setMeta("preventAutolink",!0).run():!1},toggleLink:e=>({chain:t})=>{const{href:n}=e||{};return n&&!this.options.isAllowedUri(n,{defaultValidate:r=>!!H(r,this.options.protocols),protocols:this.options.protocols,defaultProtocol:this.options.defaultProtocol})?!1:t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()},unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[j({find:e=>{const t=[];if(e){const{protocols:n,defaultProtocol:r}=this.options,s=Ye(e).filter(o=>o.isLink&&this.options.isAllowedUri(o.value,{defaultValidate:i=>!!H(i,n),protocols:n,defaultProtocol:r}));s.length&&s.forEach(o=>t.push({text:o.value,data:{href:o.href},index:o.start}))}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)==null?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[],{protocols:t,defaultProtocol:n}=this.options;return this.options.autolink&&e.push(to({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:r=>this.options.isAllowedUri(r,{defaultValidate:s=>!!H(s,t),protocols:t,defaultProtocol:n}),shouldAutoLink:this.options.shouldAutoLink})),this.options.openOnClick===!0&&e.push(no({type:this.type,editor:this.editor,enableClickSelection:this.options.enableClickSelection})),this.options.linkOnPaste&&e.push(ro({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),e}}),oo=Object.defineProperty,io=(e,t)=>{for(var n in t)oo(e,n,{get:t[n],enumerable:!0})},ao="listItem",Ve="textStyle",We=/^\s*([-+*])\s$/,Lt=$.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",x(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ao,this.editor.getAttributes(Ve)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=W({find:We,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=W({find:We,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Ve),editor:this.editor})),[e]}}),Pt=$.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",x(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),lo={};io(lo,{findListItemPos:()=>J,getNextListDepth:()=>$e,handleBackspace:()=>be,handleDelete:()=>ve,hasListBefore:()=>It,hasListItemAfter:()=>co,hasListItemBefore:()=>$t,listItemHasSubList:()=>Nt,nextListIsDeeper:()=>Ot,nextListIsHigher:()=>Rt});var J=(e,t)=>{const{$from:n}=t.selection,r=S(e,t.schema);let s=null,o=n.depth,i=n.pos,a=null;for(;o>0&&a===null;)s=n.node(o),s.type===r?a=o:(o-=1,i-=1);return a===null?null:{$pos:t.doc.resolve(i),depth:a}},$e=(e,t)=>{const n=J(e,t);if(!n)return!1;const[,r]=Yn(t,e,n.$pos.pos+4);return r},It=(e,t,n)=>{const{$anchor:r}=e.selection,s=Math.max(0,r.pos-2),o=e.doc.resolve(s).node();return!(!o||!n.includes(o.type.name))},$t=(e,t)=>{var n;const{$anchor:r}=t.selection,s=t.doc.resolve(r.pos-2);return!(s.index()===0||((n=s.nodeBefore)==null?void 0:n.type.name)!==e)},Nt=(e,t,n)=>{if(!n)return!1;const r=S(e,t.schema);let s=!1;return n.descendants(o=>{o.type===r&&(s=!0)}),s},be=(e,t,n)=>{if(e.commands.undoInputRule())return!0;if(e.state.selection.from!==e.state.selection.to)return!1;if(!B(e.state,t)&&It(e.state,t,n)){const{$anchor:a}=e.state.selection,l=e.state.doc.resolve(a.before()-1),c=[];l.node().descendants((p,f)=>{p.type.name===t&&c.push({node:p,pos:f})});const u=c.at(-1);if(!u)return!1;const d=e.state.doc.resolve(l.start()+u.pos+1);return e.chain().cut({from:a.start()-1,to:a.end()+1},d.end()).joinForward().run()}if(!B(e.state,t)||!tr(e.state))return!1;const r=J(t,e.state);if(!r)return!1;const o=e.state.doc.resolve(r.$pos.pos-2).node(r.depth),i=Nt(t,e.state,o);return $t(t,e.state)&&!i?e.commands.joinItemBackward():e.chain().liftListItem(t).run()},Ot=(e,t)=>{const n=$e(e,t),r=J(e,t);return!r||!n?!1:n>r.depth},Rt=(e,t)=>{const n=$e(e,t),r=J(e,t);return!r||!n?!1:n<r.depth},ve=(e,t)=>{if(!B(e.state,t)||!er(e.state,t))return!1;const{selection:n}=e.state,{$from:r,$to:s}=n;return!n.empty&&r.sameParent(s)?!1:Ot(t,e.state)?e.chain().focus(e.state.selection.from+4).lift(t).joinBackward().run():Rt(t,e.state)?e.chain().joinForward().joinBackward().run():e.commands.joinItemForward()},co=(e,t)=>{var n;const{$anchor:r}=t.selection,s=t.doc.resolve(r.pos-r.parentOffset-2);return!(s.index()===s.parent.childCount-1||((n=s.nodeAfter)==null?void 0:n.type.name)!==e)},Bt=E.create({name:"listKeymap",addOptions(){return{listTypes:[{itemName:"listItem",wrapperNames:["bulletList","orderedList"]},{itemName:"taskItem",wrapperNames:["taskList"]}]}},addKeyboardShortcuts(){return{Delete:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:n})=>{e.state.schema.nodes[n]!==void 0&&ve(e,n)&&(t=!0)}),t},"Mod-Delete":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:n})=>{e.state.schema.nodes[n]!==void 0&&ve(e,n)&&(t=!0)}),t},Backspace:({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{e.state.schema.nodes[n]!==void 0&&be(e,n,r)&&(t=!0)}),t},"Mod-Backspace":({editor:e})=>{let t=!1;return this.options.listTypes.forEach(({itemName:n,wrapperNames:r})=>{e.state.schema.nodes[n]!==void 0&&be(e,n,r)&&(t=!0)}),t}}}}),uo="listItem",Ke="textStyle",Ue=/^(\d+)\.\s$/,Ht=$.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return t===1?["ol",x(this.options.HTMLAttributes,n),0]:["ol",x(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(uo,this.editor.getAttributes(Ke)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=W({find:Ue,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=W({find:Ue,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(Ke)}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1],editor:this.editor})),[e]}}),po=/^\s*(\[([( |x])?\])\s$/,fo=$.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList",a11y:void 0}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{const t=e.getAttribute("data-checked");return t===""||t==="true"},renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",x(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...e,Tab:()=>this.editor.commands.sinkListItem(this.name)}:e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:n,editor:r})=>{const s=document.createElement("li"),o=document.createElement("label"),i=document.createElement("span"),a=document.createElement("input"),l=document.createElement("div"),c=()=>{var u,d;a.ariaLabel=((d=(u=this.options.a11y)==null?void 0:u.checkboxLabel)==null?void 0:d.call(u,e,a.checked))||`Task item checkbox for ${e.textContent||"empty task item"}`};return c(),o.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",u=>u.preventDefault()),a.addEventListener("change",u=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}const{checked:d}=u.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:p})=>{const f=n();if(typeof f!="number")return!1;const m=p.doc.nodeAt(f);return p.setNodeMarkup(f,void 0,{...m==null?void 0:m.attrs,checked:d}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,d)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([u,d])=>{s.setAttribute(u,d)}),s.dataset.checked=e.attrs.checked,a.checked=e.attrs.checked,o.append(a,i),s.append(o,l),Object.entries(t).forEach(([u,d])=>{s.setAttribute(u,d)}),{dom:s,contentDOM:l,update:u=>u.type!==this.type?!1:(s.dataset.checked=u.attrs.checked,a.checked=u.attrs.checked,c(),!0)}}},addInputRules(){return[W({find:po,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),ho=$.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",x(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}});E.create({name:"listKit",addExtensions(){const e=[];return this.options.bulletList!==!1&&e.push(Lt.configure(this.options.bulletList)),this.options.listItem!==!1&&e.push(Pt.configure(this.options.listItem)),this.options.listKeymap!==!1&&e.push(Bt.configure(this.options.listKeymap)),this.options.orderedList!==!1&&e.push(Ht.configure(this.options.orderedList)),this.options.taskItem!==!1&&e.push(fo.configure(this.options.taskItem)),this.options.taskList!==!1&&e.push(ho.configure(this.options.taskList)),e}});var mo=$.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",x(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),go=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,yo=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,ko=z.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",x(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[V({find:go,type:this.type})]},addPasteRules(){return[j({find:yo,type:this.type})]}}),bo=$.create({name:"text",group:"inline"}),vo=z.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",x(this.options.HTMLAttributes,e),0]},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});E.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{const t=(e==null?void 0:e.node)||this.editor.state.doc;if(((e==null?void 0:e.mode)||this.options.mode)==="textSize"){const r=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(r)}return t.nodeSize},this.storage.words=e=>{const t=(e==null?void 0:e.node)||this.editor.state.doc,n=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){let e=!1;return[new A({key:new L("characterCount"),appendTransaction:(t,n,r)=>{if(e)return;const s=this.options.limit;if(s==null||s===0){e=!0;return}const o=this.storage.characters({node:r.doc});if(o>s){const i=o-s,a=0,l=i;console.warn(`[CharacterCount] Initial content exceeded limit of ${s} characters. Content was automatically trimmed.`);const c=r.tr.deleteRange(a,l);return e=!0,c}e=!0},filterTransaction:(t,n)=>{const r=this.options.limit;if(!t.docChanged||r===0||r===null||r===void 0)return!0;const s=this.storage.characters({node:n.doc}),o=this.storage.characters({node:t.doc});if(o<=r||s>r&&o>r&&o<=s)return!0;if(s>r&&o>r&&o>s||!t.getMeta("paste"))return!1;const a=t.selection.$head.pos,l=o-r,c=a-l,u=a;return t.deleteRange(c,u),!(this.storage.characters({node:t.doc})>r)}})]}});var Mo=E.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Nn(this.options)]}});E.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new A({key:new L("focus"),props:{decorations:({doc:e,selection:t})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:s}=t,o=[];if(!n||!r)return te.create(e,[]);let i=0;this.options.mode==="deepest"&&e.descendants((l,c)=>{if(l.isText)return;if(!(s>=c&&s<=c+l.nodeSize-1))return!1;i+=1});let a=0;return e.descendants((l,c)=>{if(l.isText||!(s>=c&&s<=c+l.nodeSize-1))return!1;if(a+=1,this.options.mode==="deepest"&&i-a>0||this.options.mode==="shallowest"&&a>1)return this.options.mode==="deepest";o.push(Me.node(c,c+l.nodeSize,{class:this.options.className}))}),te.create(e,o)}}})]}});var wo=E.create({name:"gapCursor",addProseMirrorPlugins(){return[On()]},extendNodeSchema(e){var t;const n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=M(k(e,"allowGapCursor",n)))!=null?t:null}}});E.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something â¦",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new A({key:new L("placeholder"),props:{decorations:({doc:e,selection:t})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=t,s=[];if(!n)return null;const o=this.editor.isEmpty;return e.descendants((i,a)=>{const l=r>=a&&r<=a+i.nodeSize,c=!i.isLeaf&&ce(i);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];o&&u.push(this.options.emptyEditorClass);const d=Me.node(a,a+i.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:i,pos:a,hasAnchor:l}):this.options.placeholder});s.push(d)}return this.options.includeChildren}),te.create(e,s)}}})]}});E.create({name:"selection",addOptions(){return{className:"selection"}},addProseMirrorPlugins(){const{editor:e,options:t}=this;return[new A({key:new L("selection"),props:{decorations(n){return n.selection.empty||e.isFocused||!e.isEditable||ut(n.selection)||e.view.dragging?null:te.create(n.doc,[Me.inline(n.selection.from,n.selection.to,{class:t.className})])}}})]}});function qe({types:e,node:t}){return t&&Array.isArray(e)&&e.includes(t.type)||(t==null?void 0:t.type)===e}var xo=E.create({name:"trailingNode",addOptions(){return{node:"paragraph",notAfter:[]}},addProseMirrorPlugins(){const e=new L(this.name),t=Object.entries(this.editor.schema.nodes).map(([,n])=>n).filter(n=>(this.options.notAfter||[]).concat(this.options.node).includes(n.name));return[new A({key:e,appendTransaction:(n,r,s)=>{const{doc:o,tr:i,schema:a}=s,l=e.getState(s),c=o.content.size,u=a.nodes[this.options.node];if(l)return i.insert(c,u.create())},state:{init:(n,r)=>{const s=r.tr.doc.lastChild;return!qe({node:s,types:t})},apply:(n,r)=>{if(!n.docChanged)return r;const s=n.doc.lastChild;return!qe({node:s,types:t})}}})]}}),So=E.create({name:"undoRedo",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>Rn(e,t),redo:()=>({state:e,dispatch:t})=>Bn(e,t)}},addProseMirrorPlugins(){return[Hn(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Ñ":()=>this.editor.commands.undo(),"Shift-Mod-Ñ":()=>this.editor.commands.redo()}}}),Eo=E.create({name:"starterKit",addExtensions(){var e,t,n,r;const s=[];return this.options.bold!==!1&&s.push(Rs.configure(this.options.bold)),this.options.blockquote!==!1&&s.push(Ps.configure(this.options.blockquote)),this.options.bulletList!==!1&&s.push(Lt.configure(this.options.bulletList)),this.options.code!==!1&&s.push(_s.configure(this.options.code)),this.options.codeBlock!==!1&&s.push(zs.configure(this.options.codeBlock)),this.options.document!==!1&&s.push(Fs.configure(this.options.document)),this.options.dropcursor!==!1&&s.push(Mo.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&s.push(wo.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&s.push(Vs.configure(this.options.hardBreak)),this.options.heading!==!1&&s.push(Ws.configure(this.options.heading)),this.options.undoRedo!==!1&&s.push(So.configure(this.options.undoRedo)),this.options.horizontalRule!==!1&&s.push(Ks.configure(this.options.horizontalRule)),this.options.italic!==!1&&s.push(Xs.configure(this.options.italic)),this.options.listItem!==!1&&s.push(Pt.configure(this.options.listItem)),this.options.listKeymap!==!1&&s.push(Bt.configure((e=this.options)==null?void 0:e.listKeymap)),this.options.link!==!1&&s.push(so.configure((t=this.options)==null?void 0:t.link)),this.options.orderedList!==!1&&s.push(Ht.configure(this.options.orderedList)),this.options.paragraph!==!1&&s.push(mo.configure(this.options.paragraph)),this.options.strike!==!1&&s.push(ko.configure(this.options.strike)),this.options.text!==!1&&s.push(bo.configure(this.options.text)),this.options.underline!==!1&&s.push(vo.configure((n=this.options)==null?void 0:n.underline)),this.options.trailingNode!==!1&&s.push(xo.configure((r=this.options)==null?void 0:r.trailingNode)),s}}),zo=Eo;export{Do as E,zo as i,jo as u};
